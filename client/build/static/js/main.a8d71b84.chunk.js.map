{"version":3,"sources":["components/Header.js","components/Footer.js","components/NotFound.js","components/HowTo.js","components/StatCards.js","API.js","helpers/AnimationHelper.js","containers/Livemap.js","helpers/tripsRTL.js","helpers/tripsSTM.js","containers/Livetrips.js","helpers/routesRTL.js","helpers/routesSTM.js","containers/Liveroutes.js","containers/Historique.js","containers/Statsgtfs.js","components/Routes.js","App.js","index.js"],"names":["Header","react_default","a","createElement","Fragment","id","className","type","data-toggle","data-target","aria-controls","aria-expanded","aria-label","style","color","react_router_dom","to","textDecoration","Footer","href","NotFound","HowTo","StatCards","this","props","lastRefreshSTM","substr","onlineVehiclesSTM","plannedVehiclesSTM","routesSTM","lastRefreshSTL","onlineVehiclesSTL","plannedVehiclesSTL","routesSTL","lastRefreshRTL","onlineVehiclesRTL","plannedVehiclesRTL","routesRTL","lastRefreshEXO","onlineVehiclesEXO","plannedVehiclesEXO","routesEXO","Component","socket","io","connect","transports","getNewData","_x","_getNewData","apply","arguments","_callee","cb","regenerator_default","wrap","_context","prev","next","on","data","emit","stop","leave","_leave","_callee2","_context2","getTracesSTM","_getTracesSTM","_callee3","response","_context3","fetch","sent","abrupt","json","getStopsSTM","_x2","_getStopsSTM","_callee4","trip","_context4","method","headers","Content-Type","body","JSON","stringify","getTracesSTL","_getTracesSTL","_callee5","_context5","getStopsSTL","_x3","_getStopsSTL","_callee6","trace","_context6","getTracesRTL","_getTracesRTL","_callee7","_context7","getStopsRTL","_x4","_getStopsRTL","_callee8","_context8","getHistory","_getHistory","_callee9","_context9","getStatsGtfs","_getStatsGtfs","_callee10","_context10","require","Livemap","state","viewport","latitude","longitude","zoom","componentDidMount","map","tracesSTM","tracesSTL","tracesRTL","err","positions","vehSTM","filter","e","reseau","vehSTL","vehRTL","vehEXO","groupe","vehFeatEXO","features","forEach","f","i","push","_this","setState","vehiclesSTM","vehiclesSTL","vehiclesRTL","vehiclesEXO","timestampSTM","timestr","timestampSTL","timestampRTL","timestampEXO","plannedTripsRTL","plannedTripsSTL","plannedTripsSTM","reactMap","getMap","handleOnLoad","rows","jsonb_build_object","componentWillUnmount","remove","emptyGeoJSON","addSource","addLayer","source","layout","text-field","String","fromCharCode","text-font","text-size","paint","text-color","line-join","line-cap","visibility","line-width","line-color","circle-radius","circle-color","mapIsLoaded","componentDidUpdate","prevProps","prevState","_this$state","vehRoutesSTM","uniqueRoutesSTM","vehRoutesSTL","uniqueRoutesSTL","vehRoutesRTL","uniqueRoutesRTL","vehRoutesEXO","uniqueRoutesEXO","getSource","setData","properties","route_id","Object","toConsumableArray","Set","_onViewportChange","_onHover","event","_event$srcEvent","srcEvent","offsetX","offsetY","hoveredFeatureSTM","find","layer","hoveredStopSTM","hoveredFeatureSTL","hoveredFeatureRTL","hoveredFeatureEXO","x","y","stopRequestSTM","stopsResponseSTM","parseStopsSTM","stopRequestRTL","stopsResponseRTL","parseStopsRTL","stopRequestSTL","stopsResponseSTL","parseStopsSTL","_onClick","_event$srcEvent2","clickedFeatureSTM","clickedFeatureSTL","clickedFeatureRTL","tripClickSTM","routeClickSTL","tripClickRTL","traceSTM","traceSTL","traceRTL","stopsSTM","stopsRTL","stopsSTL","console","log","trip_id","trips","some","route_short_name","t0","t1","ID","t2","_this$state2","tripHoverSTM","routeHoverSTL","tripHoverRTL","tripHoverEXO","tracesEXO","left","top","vehicle_id","timestamp","last_connection","cit","_this2","components_StatCards","length","plannedTripsEXO","esm","assign","ref","width","height","mapStyle","onViewportChange","mapboxApiAccessToken","process","onHover","onClick","_renderTooltip","turf","calcGraphsTripsRTL","_x5","_calcGraphsTripsRTL","visibleChartTripsLiveUpdate","plannedTrips","stops","stopsCounter","keyID","tripIDS","tripmin","position","indexOf","tripStops","name","time","departure_time","stop_sequence","z","currentPositionFeature","geometry","coordinates","g","coordTrace","turfLine","lineString","pt","point","snapped","nearestPointOnLine","units","dist","Math","round","location","splice","keyid","graph","online","timemin","parseInt","timemax","es6","dataKey","hide","range","domain","content","_ref","active","payload","fill","stroke","line","shape","calcGraphsTripsSTM","_calcGraphsTripsSTM","stop_distances","stopsequence","moment","Livetrips","tripList","selectStops","selectSTM","selectSTL","selectRTL","keyIDRTL","keyIDSTM","sort","b","regenGraphRTL","regenGraphSTM","handleClickSTM","plannedTripsWithGraphs","handleClickRTL","visibleChartTrips","_iteratorNormalCompletion","_didIteratorError","_iteratorError","_loop","_iterator","_step","visibleChartTripsUpdate","undefined","mark","value","tripID","Symbol","iterator","done","delegateYield","return","finish","_iteratorNormalCompletion2","_didIteratorError2","_iteratorError2","_loop2","_iterator2","_step2","addToTripList","tripListAdd","_context11","removeFromTripList","tripListRemove","tripPosition","stopListRemove","_context12","handleTripClickRTL","_callee11","_context13","target","innerHTML","handleTripClickSTM","_callee12","_context14","textAlign","backgroundColor","disabled","key","direction_id","startOf","seconds","format","cursor","colSpan","react_loading_default","longestRoutesRTL","ligneDir","stopcount","ligneDirOnline","Array","from","s","regenGraphRoutesRTL","routeList","visibleChartRoutes","tripsLigneDir","routeIDS","distArray","k","longestRoutesSTM","regenGraphRoutesSTM","Liveroutes","plannedRoutesWithGraphs","completeTracesRTL","completeTracesSTM","plannedRoutesRTL","plannedRoutesSTM","uniqueTrip","_i","_uniqueTrip","_i2","_uniqueTrip2","addToRouteList","routeListAdd","removeFromRouteList","routeListRemove","routePosition","handleRouteClickRTL","handleRouteClickSTM","Historique","history","allVehicles","parseAll","week","saturday","sunday","vehlen","Number","sum","weekday","date","rid","CustomTooltip","_ref2","margin","right","bottom","tickFormatter","unixTime","ticks","yAxisId","label","angle","orientation","Statsgtfs","Routes","react_router","exact","path","component","App","components_Header","components_Routes","components_Footer","ReactDOM","render","src_App_0","document","getElementById"],"mappings":"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","file":"static/js/main.a8d71b84.chunk.js","sourcesContent":["import React from 'react';\nimport { Link } from 'react-router-dom';\n\nconst Header = () => (\n\n  <React.Fragment>\n\n    <div id=\"headnav\" className=\"container-fluid\">\n      <nav className=\"navbar navbar-expand-md\">\n        <p className=\"navbar-brand mb-0 h1 text-white\"><i className=\"fas fa-rss\"></i> busr</p>\n        <button className=\"navbar-toggler\" type=\"button\" data-toggle=\"collapse\" data-target=\"#navbarNavAltMarkup\" aria-controls=\"navbarNavAltMarkup\" aria-expanded=\"false\" aria-label=\"Toggle navigation\">\n          <i className=\"fas fa-bars\" style={{ color: '#FFFFFF' }}></i>\n        </button>\n        <div className=\"collapse navbar-collapse\" id=\"navbarNavAltMarkup\">\n          <div className=\"navbar-nav\">\n            <Link className=\"nav-item nav-link text-white\" to=\"/\" style={{ textDecoration: 'none', color: '#FFFFFF' }}>\n              Carte\n            </Link>\n            <Link className=\"nav-item nav-link text-white\" to=\"/historique\" style={{ textDecoration: 'none', color: '#FFFFFF' }}>\n              Courbe de service\n              </Link>\n            {//<Link className=\"nav-item nav-link text-white\" to=\"/liveroutes\" style={{ textDecoration: 'none', color: '#FFFFFF' }}>\n              //Vue linaire\n            //</Link>\n          }\n            <Link className=\"nav-item nav-link text-white\" to=\"/statsgtfs\" style={{ textDecoration: 'none', color: '#FFFFFF' }}>\n              Stats GTFS\n            </Link>\n\n            {/*<li className=\"nav-item dropdown\">\n              <a className=\"nav-link dropdown-toggle\" href=\"#\" id=\"navbarDropdown\" role=\"button\" data-toggle=\"dropdown\" aria-haspopup=\"true\" aria-expanded=\"false\"\n                style={{ textDecoration: 'none', color: '#FFFFFF' }}>\n                Vue linaire\n              </a>\n              <div className=\"dropdown-menu\" aria-labelledby=\"navbarDropdown\">\n                <Link className=\"dropdown-item\" to=\"/livetrips\" style={{ textDecoration: 'none' }}>\n                  Par voyage\n                </Link>\n                <Link className=\"dropdown-item\" to=\"/liveroutes\" style={{ textDecoration: 'none' }}>\n                  Par ligne\n                </Link>\n              </div>\n</li>*/}\n            {/*<Link className=\"nav-item nav-link text-white\" to=\"/howto\" style={{ textDecoration: 'none', color: '#FFFFFF' }}>\n              Aide\n</Link>*/}\n          </div>\n        </div>\n      </nav>\n    </div>\n\n  </React.Fragment>\n);\n\nexport default Header;","import React from 'react';\n\nconst Footer = () => (\n  <div className=\"container-fluid\">\n    <nav className=\"navbar sticky-bottom navbar-light bg-light\">\n      <span className=\"navbar-brand\"><a id=\"footer-name\" style={{ textDecoration: 'none' }} href=\"https://www.github.com/willdk3000/busr\">&copy; busr 2019</a></span>\n    </nav>\n  </div >\n);\n\nexport default Footer;","import React from 'react';\n\nconst NotFound = () => (\n    <div className=\"container-fluid\">\n        <div className=\"jumbotron\">\n            <div className=\"container\">\n                <h1 className=\"display-4\">Not found...</h1>\n                <p className=\"lead\">The page you are looking for is unavailable.</p>\n            </div>\n        </div>\n    </div>\n)\n\nexport default NotFound;","import React from 'react';\nimport { Link } from 'react-router-dom';\n\nconst HowTo = () => (\n  <React.Fragment>\n    <div className=\"container-fluid\">\n      <div className=\"row\">\n        <div className=\"col-sm\">\n          <h1 id=\"title-card\" className=\"display-4\">Utilisation de busr</h1>\n        </div>\n      </div>\n      <div className=\"jumbotron\">\n        <div className=\"container\">\n          <h1 className=\"display-4\">busr = bus + realtime</h1>\n          <p className=\"lead\">busr est un tableau de bord qui utilise les donnes ouvertes disponibles pour visualiser en temps rel l'tat du service d'autobus de la STM, de la STL et du RTL</p>\n        </div>\n      </div>\n    </div>\n  </React.Fragment>\n);\n\nexport default HowTo;","import React, { Component } from 'react';\n\nclass StatCards extends Component {\n  render() {\n    return (\n      <React.Fragment>\n        <div className=\"container-fluid\">\n          <div className=\"row\">\n            <div className=\"col-sm\" id=\"stat-card\">\n              <div id='nom-stat'>Agence :</div>\n              <div id='stat'>STM</div>\n            </div>\n            <div className=\"col-sm\" id=\"stat-card\">\n              <div id='nom-stat'>API :</div>\n              <div id='stat'>gtfs-r</div>\n            </div>\n            <div className=\"col-sm\" id=\"stat-card\">\n              <div id='nom-stat'>Mise  jour :</div>\n              <div id='stat'>{this.props.lastRefreshSTM.substr(0, 8)}</div>\n            </div>\n            <div className=\"col-sm\" id=\"stat-card\">\n              <div id='nom-stat'>Vhicules actifs / planifis :</div>\n              <div id='stat'>{this.props.onlineVehiclesSTM} / {this.props.plannedVehiclesSTM}</div>\n            </div>\n            <div className=\"col-sm\" id=\"stat-card\">\n              <div id='nom-stat'>Lignes en service :</div>\n              <div id='stat'>{this.props.routesSTM}</div>\n            </div>\n          </div>\n          <div className=\"row\">\n            <div className=\"col-sm\" id=\"stat-card\">\n              <div id='nom-stat'>Agence :</div>\n              <div id='stat'>STL</div>\n            </div>\n            <div className=\"col-sm\" id=\"stat-card\">\n              <div id='nom-stat'>API :</div>\n              <div id='stat'>nextbus</div>\n            </div>\n            <div className=\"col-sm\" id=\"stat-card\">\n              <div id='nom-stat'>Mise  jour :</div>\n              <div id='stat'>{this.props.lastRefreshSTL.substr(0, 8)}</div>\n            </div>\n            <div className=\"col-sm\" id=\"stat-card\">\n              <div id='nom-stat'>Vhicules actifs / planifis :</div>\n              <div id='stat'>{this.props.onlineVehiclesSTL} / {this.props.plannedVehiclesSTL}</div>\n            </div>\n            <div className=\"col-sm\" id=\"stat-card\">\n              <div id='nom-stat'>Lignes en service :</div>\n              <div id='stat'>{this.props.routesSTL}</div>\n            </div>\n          </div>\n          <div className=\"row\">\n            <div className=\"col-sm\" id=\"stat-card\">\n              <div id='nom-stat'>Agence :</div>\n              <div id='stat'>RTL</div>\n            </div>\n            <div className=\"col-sm\" id=\"stat-card\">\n              <div id='nom-stat'>API :</div>\n              <div id='stat'>gtfs-r</div>\n            </div>\n            <div className=\"col-sm\" id=\"stat-card\">\n              <div id='nom-stat'>Mise  jour :</div>\n              <div id='stat'>{this.props.lastRefreshRTL.substr(0, 8)}</div>\n            </div>\n            <div className=\"col-sm\" id=\"stat-card\">\n              <div id='nom-stat'>Vhicules actifs / planifis :</div>\n              <div id='stat'>{this.props.onlineVehiclesRTL} / {this.props.plannedVehiclesRTL}</div>\n            </div>\n            <div className=\"col-sm\" id=\"stat-card\">\n              <div id='nom-stat'>Lignes en service :</div>\n              <div id='stat'>{this.props.routesRTL}</div>\n            </div>\n          </div>\n          <div className=\"row\">\n            <div className=\"col-sm\" id=\"stat-card\">\n              <div id='nom-stat'>Agence :</div>\n              <div id='stat'>exo</div>\n              <div id ='nom-stat'>Tracs  venir</div>\n            </div>\n            <div className=\"col-sm align-middle\" id=\"stat-card\">\n              <div id='nom-stat'>API :</div>\n              <div id='stat'>gtfs-r</div>\n            </div>\n            <div className=\"col-sm\" id=\"stat-card\">\n              <div id='nom-stat'>Mise  jour :</div>\n              <div id='stat'>{this.props.lastRefreshEXO.substr(0, 8)}</div>\n            </div>\n            <div className=\"col-sm\" id=\"stat-card\">\n              <div id='nom-stat'>Vhicules actifs / planifis :</div>\n              <div id='stat'>{this.props.onlineVehiclesEXO} / {this.props.plannedVehiclesEXO}</div>\n            </div>\n            <div className=\"col-sm\" id=\"stat-card\">\n              <div id='nom-stat'>Lignes en service :</div>\n              <div id='stat'>{this.props.routesEXO}</div>\n            </div>\n          </div>\n        </div>\n      </React.Fragment >\n    );\n  }\n}\n\nexport default StatCards;","import io from \"socket.io-client\";\n\n//const API_URL = 'http://192.168.0.146:5000'\n\n// const socket = process.env.NODE_ENV === 'production' ?\n//   io.connect('busr.ngrok.io', { transports: ['websocket'] }) :\n//   io.connect('http://192.168.0.174:5000', { transports: ['websocket'] })\n\n//const socket = io.connect('http://192.168.0.112:5000', { transports: ['websocket'] })\nconst socket = io.connect('wss://busr.ngrok.io', { transports: ['websocket'] })\n\n\n// Fonctions realtime\n\nexport async function getNewData(cb) {\n\n  // socket.on('message-client-connected', (message) => {\n  //   console.log(message)\n  // })\n\n  socket.on('refresh data', data => cb(null, data))\n\n  socket.emit('subscribeToTimer', 3000);\n\n}\n\n\nexport async function leave() {\n  socket.emit('leave');\n}\n\n\n// Donnes pour cartographie\n\nexport async function getTracesSTM() {\n  const response = await fetch('/api/traces_stm')\n  return response.json();\n};\n\nexport async function getStopsSTM(trip) {\n  const response = await fetch('/api/stops_stm', {\n    method: 'POST',\n    headers: {\n      'Content-Type': 'application/json'\n    },\n    body: JSON.stringify({ \"trip\": trip })\n  });\n  return response.json()\n}\n\n\nexport async function getTracesSTL() {\n  const response = await fetch('/api/traces_stl');\n  return response.json();\n};\n\nexport async function getStopsSTL(trace) {\n  const response = await fetch('/api/stops_stl', {\n    method: 'POST',\n    headers: {\n      'Content-Type': 'application/json'\n    },\n    body: JSON.stringify({ \"trace\": trace })\n  });\n  return response.json()\n}\n\n\nexport async function getTracesRTL() {\n  const response = await fetch('/api/traces_rtl');\n  return response.json();\n};\n\n\nexport async function getStopsRTL(trip) {\n  const response = await fetch('/api/stops_rtl', {\n    method: 'POST',\n    headers: {\n      'Content-Type': 'application/json'\n    },\n    body: JSON.stringify({ \"trip\": trip })\n  });\n  return response.json()\n}\n\n\n// Donnes pour graphiques\n\nexport async function getHistory() {\n  const response = await fetch('/api/allvehicles')\n  return response.json()\n};\n\n\n// Donnes pour Stats GTFS\n\nexport async function getStatsGtfs() {\n  const response = await fetch('/api/statsgtfs')\n  return response.json()\n};\n","const turf = require('@turf/turf');\n\nexport async function tripsToArcsRTL(pointsDepart, pointsArrivee, shapes) {\n\n  //POUR L'INSTANT, NE TIENT PAS COMPTE DES POINTS POUR LESQUELS ON AURAIT \n  //SEULEMENT LE DEPART OU SEULEMENT L'ARRIVEE\n\n  // Step 1 : put each active shape in shape array\n  //let emptyGeoJSON = { \"type\": \"FeatureCollection\", \"features\": [] }\n  let shapeArray = [];\n\n  const buildShapeArray = shapes ? pointsDepart.features.forEach((e) => {\n    if (pointsArrivee.features.filter((f) => {\n      return f.properties.trip_id === e.properties.trip_id\n    }).length > 0) {\n      shapeArray.push(shapes.features.filter((f) => {\n        return f.properties.trips.some((g) => {\n          return g === e.properties.trip_id\n        })\n      }))\n    } //else {\n    //shapeArray.push(emptyGeoJSON)\n    //}\n  }) : ''\n  //console.log(shapeArray);\n\n  // Step 2 : slice shapes between start and stop\n  let i = 0;\n  let start = [];\n  let stop = [];\n  let line = [];\n  let slicedShapes = [];\n\n  //console.log(shapeArray[1]);\n\n  shapeArray.forEach((e) => {\n    start = turf.point(pointsDepart.features[i].geometry.coordinates);\n    stop = turf.point(pointsArrivee.features[i].geometry.coordinates);\n    line = turf.lineString(e[0].geometry.coordinates);\n    slicedShapes.push(turf.lineSlice(start, stop, line));\n    i++;\n  })\n\n  //console.log(slicedShapes)\n\n  // Step 3 : calculate sliced shape distances \n  //CES DISTANCES PEUVENT ETRE UTILISEES POUR CALCULER LA VITESSE\n\n  i = 0;\n  let sliceDistances = [];\n  slicedShapes.forEach((e) => {\n    sliceDistances.push(turf.lineDistance(slicedShapes[i]));\n    i++;\n  })\n\n  //console.log(sliceDistances)\n\n  // Step 4 : break shapes into segments based on number of steps\n  // 5m / step\n\n  let arc = [];\n  let j = 0;\n\n  slicedShapes.forEach((e) => {\n    for (let i = 0; i < sliceDistances[j]; i += sliceDistances[j] / (sliceDistances[j] / 5)) {\n      let line = turf.lineString(slicedShapes[j].geometry.coordinates);\n      let segment = turf.along(line, i);\n      arc.push(segment.geometry.coordinates);\n    }\n    slicedShapes[j].geometry.coordinates = arc;\n    j++;\n  })\n\n  return slicedShapes;\n\n}\n\n\n// Fonction d'animation \n\nexport async function animate(map, pointsDepart, arcs, featureIdx, cntr) {\n  // Update point geometry to a new position based on counter denoting\n  // the index to access the arc.\n  if (cntr >= arcs[featureIdx].geometry.coordinates.length - 1) {\n    return;\n  }\n\n  pointsDepart[featureIdx].geometry.coordinates = pointsDepart[featureIdx].geometry.coordinates[cntr];\n\n\n  pointsDepart[featureIdx].properties.bearing = turf.bearing(\n    turf.point(arcs[featureIdx].geometry.coordinates[cntr >= arcs[featureIdx].geometry.coordinates.length ? cntr - 1 : cntr]),\n    turf.point(arcs[featureIdx].geometry.coordinates[cntr >= arcs[featureIdx].geometry.coordinates.length ? cntr : cntr + 1])\n  );\n\n  // Update the source with this new data.\n  map.getSource('vehiculesRTL').setData(pointsDepart);\n\n  // Request the next frame of animation so long the end has not been reached.\n  if (cntr < arcs[featureIdx].geometry.coordinates.length) {\n    requestAnimationFrame(function () { animate(featureIdx, cntr + 1); });\n  }\n\n}","import React, { Component } from 'react';\nimport MapGL from 'react-map-gl';\nimport StatCards from '../components/StatCards.js'\n\nimport {\n  getNewData, leave,\n  getTracesSTM, getTracesSTL, getTracesRTL,\n  getStopsSTM, getStopsRTL, getStopsSTL\n} from '../API.js'\n\nimport {\n  tripsToArcsRTL, animate\n} from '../helpers/AnimationHelper.js'\n\nclass Livemap extends Component {\n\n  state = {\n    viewport: {\n      latitude: 45.556827,\n      longitude: -73.662362,\n      zoom: 9\n    }\n  };\n\n\n  componentDidMount = async () => {\n\n    const getData = getNewData((err, positions) => {\n\n      const vehSTM = positions ? positions[0].filter((e) => {\n        return e.reseau === 'STM'\n      }) : ''\n\n      const vehSTL = positions ? positions[0].filter((e) => {\n        return e.reseau === 'STL'\n      }) : ''\n\n      const vehRTL = positions ? positions[0].filter((e) => {\n        return e.reseau === 'RTL'\n      }) : ''\n\n      const vehEXO = positions ? positions[0].filter((e) => {\n        return e.groupe === 'exo'\n      }) : ''\n\n      const vehFeatEXO={type: 'FeatureCollection', features: []};\n\n      // Merge de tous les features des CIT dans un seul objet pour EXO (moins complique pour l'affichage)\n      // Ajout du nom du CIT dans les proprietes de chaque feature pour les distinguer\n      vehEXO.forEach((e)=>{\n        e.data.features.forEach(((f, i)=>{\n          vehFeatEXO.features.push(f);\n        }))\n      })\n\n      this.setState({\n        vehiclesSTM: vehSTM[0].data,\n        vehiclesSTL: vehSTL[0].data,\n        vehiclesRTL: vehRTL[0].data,\n        vehiclesEXO: vehFeatEXO,\n        timestampSTM: vehSTM[0].timestr,\n        timestampSTL: vehSTL[0].timestr,\n        timestampRTL: vehRTL[0].timestr,\n        timestampEXO: vehEXO[0].timestr,\n        plannedTripsRTL: positions ? positions[1] : '',\n        plannedTripsSTL: positions ? positions[2] : '',\n        plannedTripsSTM: positions ? positions[3] : ''\n      })\n\n\n      \n    })\n\n    const map = this.reactMap.getMap();\n\n    //Initialize map\n    this.handleOnLoad(map)\n\n    const tracesSTM = await getTracesSTM();\n    this.setState({\n      tracesSTM: tracesSTM.rows[0].jsonb_build_object\n    })\n\n    const tracesSTL = await getTracesSTL();\n    this.setState({\n      tracesSTL: tracesSTL.rows[0].jsonb_build_object\n    })\n\n    const tracesRTL = await getTracesRTL();\n    this.setState({\n      tracesRTL: tracesRTL.rows[0].jsonb_build_object\n    })\n\n  }\n\n\n  componentWillUnmount = async () => {\n    this.map.remove();\n    leave();\n  }\n\n\n  handleOnLoad = async (map) => {\n    let emptyGeoJSON = { \"type\": \"FeatureCollection\", \"features\": [] }\n\n    map.on('load', () => {\n\n      // Add empty geojson to map on initialization to prevent mapbox error. \n      // Map has to contain valid geojson on load\n\n      // Sources - vehicles\n      map.addSource(\n        \"vehiculesSTM\", {\n        \"type\": \"geojson\",\n        \"data\": emptyGeoJSON\n      }\n      );\n\n      map.addSource(\n        \"vehiculesSTL\", {\n        \"type\": \"geojson\",\n        \"data\": emptyGeoJSON\n      }\n      );\n\n      map.addSource(\n        \"vehiculesRTL\", {\n        \"type\": \"geojson\",\n        \"data\": emptyGeoJSON\n      }\n      );\n\n\n      map.addSource(\n        \"vehiculesEXO\", {\n        \"type\": \"geojson\",\n        \"data\": emptyGeoJSON\n      }\n      );\n\n      // Sources - traces\n      map.addSource(\n        \"tracesSTM\", {\n        \"type\": \"geojson\",\n        \"data\": emptyGeoJSON\n      }\n      );\n\n      map.addSource(\n        \"tracesSTL\", {\n        \"type\": \"geojson\",\n        \"data\": emptyGeoJSON\n      }\n      );\n\n      map.addSource(\n        \"tracesRTL\", {\n        \"type\": \"geojson\",\n        \"data\": emptyGeoJSON\n      }\n      );\n\n      // Sources - stops\n      map.addSource(\n        \"stopsSTM\", {\n        \"type\": \"geojson\",\n        \"data\": emptyGeoJSON\n      }\n      );\n\n      map.addSource(\n        \"stopsRTL\", {\n        \"type\": \"geojson\",\n        \"data\": emptyGeoJSON\n      }\n      );\n\n      map.addSource(\n        \"stopsSTL\", {\n        \"type\": \"geojson\",\n        \"data\": emptyGeoJSON\n      }\n      );\n\n      // Sources shapes ANIM\n      // map.addSource(\n      //   'routeAnimRTL', {\n      //   \"type\": \"geojson\",\n      //   \"data\": emptyGeoJSON\n      // });\n\n      // For bus icons, use following symbol 0xF207 \n      // 0x characters to add to each icon\n      // F207 identifier of bus icon in fontawesome\n      // FontAwesome has to be loaded as one of the fonts in the map style (see mapbox studio)\n\n      // Vehicles layers\n      map.addLayer(\n        {\n          \"id\": \"position-vehicules-stm\",\n          \"type\": \"symbol\",\n          \"source\": \"vehiculesSTM\",\n          \"layout\": {\n            'text-field': String.fromCharCode(\"0xF207\"),\n            'text-font': ['Font Awesome 5 Free Solid'],\n            'text-size': 12\n          },\n          \"paint\": {\n            \"text-color\": \"#009DE0\"\n          }\n        }\n      );\n\n      map.addLayer(\n        {\n          \"id\": \"position-vehicules-stl\",\n          \"type\": \"symbol\",\n          \"source\": \"vehiculesSTL\",\n          \"layout\": {\n            'text-field': String.fromCharCode(\"0xF207\"),\n            'text-font': ['Font Awesome 5 Free Solid'],\n            'text-size': 12\n          },\n          \"paint\": {\n            \"text-color\": \"#82C341\"\n          }\n        }\n      );\n\n      map.addLayer(\n        {\n          \"id\": \"position-vehicules-rtl\",\n          \"type\": \"symbol\",\n          \"source\": \"vehiculesRTL\",\n          \"layout\": {\n            'text-field': String.fromCharCode(\"0xF207\"),\n            'text-font': ['Font Awesome 5 Free Solid'],\n            'text-size': 12\n          },\n          \"paint\": {\n            \"text-color\": \"#A93332\"\n          }\n        }\n      );\n\n\n      map.addLayer(\n        {\n          \"id\": \"position-vehicules-exo\",\n          \"type\": \"symbol\",\n          \"source\": \"vehiculesEXO\",\n          \"layout\": {\n            'text-field': String.fromCharCode(\"0xF207\"),\n            'text-font': ['Font Awesome 5 Free Solid'],\n            'text-size': 12\n          },\n          \"paint\": {\n            \"text-color\": \"#000000\"\n          }\n        }\n      );\n\n      // Traces layers\n      map.addLayer({\n        \"id\": \"tracesSTM\",\n        \"type\": \"line\",\n        \"source\": \"tracesSTM\",\n        \"layout\": {\n          \"line-join\": \"round\",\n          \"line-cap\": \"round\",\n          \"visibility\": \"visible\"\n        },\n        \"paint\": {\n          \"line-width\": 2,\n          \"line-color\": \"#2380A5\"\n        }\n      });\n\n      map.addLayer({\n        \"id\": \"tracesSTL\",\n        \"type\": \"line\",\n        \"source\": \"tracesSTL\",\n        \"layout\": {\n          \"line-join\": \"round\",\n          \"line-cap\": \"round\",\n          \"visibility\": \"visible\"\n        },\n        \"paint\": {\n          \"line-width\": 2,\n          \"line-color\": \"#4A913C\"\n        }\n      });\n\n      map.addLayer({\n        \"id\": \"tracesRTL\",\n        \"type\": \"line\",\n        \"source\": \"tracesRTL\",\n        \"layout\": {\n          \"line-join\": \"round\",\n          \"line-cap\": \"round\",\n          \"visibility\": \"visible\"\n        },\n        \"paint\": {\n          \"line-width\": 2,\n          \"line-color\": \"#C47B85\"\n        }\n      });\n\n      // Stops layers\n      map.addLayer(\n        {\n          \"id\": \"stopsSTM\",\n          \"type\": \"circle\",\n          \"source\": \"stopsSTM\",\n          \"paint\": {\n            \"circle-radius\": 3,\n            \"circle-color\": \"#009DE0\"\n          }\n        }\n      );\n\n      map.addLayer(\n        {\n          \"id\": \"stopsRTL\",\n          \"type\": \"circle\",\n          \"source\": \"stopsRTL\",\n          \"paint\": {\n            \"circle-radius\": 3,\n            \"circle-color\": \"#A93332\"\n          }\n        }\n      );\n\n      map.addLayer(\n        {\n          \"id\": \"stopsSTL\",\n          \"type\": \"circle\",\n          \"source\": \"stopsSTL\",\n          \"paint\": {\n            \"circle-radius\": 3,\n            \"circle-color\": \"#82C341\"\n          }\n        }\n      );\n\n      // Couches route ANIM\n\n      // map.addLayer({\n      //   \"id\": \"routeAnimRTL\",\n      //   \"source\": \"routeAnimRTL\",\n      //   \"type\": \"line\",\n      //   \"paint\": {\n      //     \"line-width\": 0,\n      //     \"line-color\": \"#007cbf\"\n      //   }\n      // });\n\n      this.setState({ mapIsLoaded: true });\n\n    })\n\n    this.map = map;\n  }\n\n\n  //rafraichir les donnees avec les nouvelles donnees recues de socketio\n  //au moment du update du component\n  componentDidUpdate = async (prevProps, prevState) => {\n    const { vehiclesSTM, vehiclesSTL, vehiclesRTL, vehiclesEXO } = this.state;\n    const { mapIsLoaded } = this.state;\n\n    if (!mapIsLoaded) {\n      return;\n    }\n\n    // Gestion vehicules STM\n    if (vehiclesSTM !== prevState.vehiclesSTM) {\n      this.map.getSource(\"vehiculesSTM\").setData(vehiclesSTM);\n\n      const vehRoutesSTM = this.state.vehiclesSTM ? this.state.vehiclesSTM.features.map((e) => {\n        return e.properties.route_id\n      }) : ''\n\n      const uniqueRoutesSTM = [...new Set(vehRoutesSTM)]\n\n      this.setState({ routesSTM: uniqueRoutesSTM })\n\n    }\n\n    // Gestion vehicules STL\n    if (vehiclesSTL !== prevState.vehiclesSTL) {\n      this.map.getSource(\"vehiculesSTL\").setData(vehiclesSTL);\n\n      const vehRoutesSTL = this.state.vehiclesSTL ? this.state.vehiclesSTL.features.map((e) => {\n        return e.properties.route_id\n      }) : ''\n\n      const uniqueRoutesSTL = [...new Set(vehRoutesSTL)]\n\n      this.setState({ routesSTL: uniqueRoutesSTL })\n    }\n\n    // Gestion vehicules RTL\n    if (vehiclesRTL !== prevState.vehiclesRTL) {\n      this.map.getSource(\"vehiculesRTL\").setData(vehiclesRTL);\n\n      const vehRoutesRTL = this.state.vehiclesRTL ? this.state.vehiclesRTL.features.map((e) => {\n        return e.properties.route_id\n      }) : ''\n\n      const uniqueRoutesRTL = [...new Set(vehRoutesRTL)]\n\n      this.setState({ routesRTL: uniqueRoutesRTL })\n\n    }\n\n  \n    if (vehiclesEXO !== prevState.vehiclesEXO) {\n\n      this.map.getSource(\"vehiculesEXO\").setData(vehiclesEXO);\n\n      const vehRoutesEXO = this.state.vehiclesEXO ? this.state.vehiclesEXO.features.map((e) => {\n        return e.properties.route_id\n      }) : ''\n\n      const uniqueRoutesEXO = [...new Set(vehRoutesEXO)]\n\n      this.setState({ routesEXO: uniqueRoutesEXO })\n\n    }\n\n          // Animation\n      // if (prevState.vehiclesRTL && this.state.vehiclesRTL) {\n      //   const arcsRTL = await tripsToArcsRTL(prevState.vehiclesRTL, this.state.vehiclesRTL, this.state.tracesRTL);\n\n      //   // console.log(arcsRTL)\n      //   // console.log(prevState.vehiclesRTL.features)\n\n      //   // let i = 0;\n      //   // prevState.vehiclesRTL.features.forEach((e) => {\n      //   //   animate(this.map, prevState.vehiclesRTL.features, arcsRTL, i, 0)\n      //   //   i++\n      //   // })\n\n      // }\n\n\n    //console.log(this.state)\n\n  }\n\n\n\n  _onViewportChange = viewport => this.setState({ viewport });\n\n\n  _onHover = event => {\n    const { features, srcEvent: { offsetX, offsetY } } = event;\n\n    const hoveredFeatureSTM = features && features.find(f => f.layer.id === 'position-vehicules-stm');\n    const hoveredStopSTM = features && features.find(f => f.layer.id === 'stopsSTM');\n\n    const hoveredFeatureSTL = features && features.find(f => f.layer.id === 'position-vehicules-stl');\n\n    const hoveredFeatureRTL = features && features.find(f => f.layer.id === 'position-vehicules-rtl');\n\n    const hoveredFeatureEXO = features && features.find(f => f.layer.id === 'position-vehicules-exo');\n\n    this.setState({\n      hoveredFeatureSTM,\n      hoveredStopSTM,\n      hoveredFeatureSTL,\n      hoveredFeatureRTL,\n      hoveredFeatureEXO,\n      x: offsetX,\n      y: offsetY\n    });\n\n  };\n\n\n  stopRequestSTM = async (trip) => {\n    const stopsResponseSTM = await getStopsSTM(trip);\n    const parseStopsSTM = stopsResponseSTM.rows[0].jsonb_build_object\n    return parseStopsSTM\n  }\n\n  stopRequestRTL = async (trip) => {\n    const stopsResponseRTL = await getStopsRTL(trip);\n    const parseStopsRTL = stopsResponseRTL.rows[0].jsonb_build_object\n    return parseStopsRTL\n  }\n\n  stopRequestSTL = async (trace) => {\n    const stopsResponseSTL = await getStopsSTL(trace);\n    const parseStopsSTL = stopsResponseSTL.rows[0].jsonb_build_object\n    return parseStopsSTL\n  }\n\n\n  _onClick = async (event) => {\n\n    const { mapIsLoaded } = this.state;\n\n    let emptyGeoJSON = { \"type\": \"FeatureCollection\", \"features\": [] }\n\n    const { features, srcEvent: { offsetX, offsetY } } = event;\n    const clickedFeatureSTM = features && features.find(f => f.layer.id === 'position-vehicules-stm');\n    const clickedFeatureSTL = features && features.find(f => f.layer.id === 'position-vehicules-stl');\n    const clickedFeatureRTL = features && features.find(f => f.layer.id === 'position-vehicules-rtl');\n\n    console.log(clickedFeatureSTM);\n\n    // Identification du trip (stm, rtl) ou de la ligne (stl) cliqu\n    const tripClickSTM = clickedFeatureSTM ? clickedFeatureSTM.properties.trip_id : '';\n    const routeClickSTL = clickedFeatureSTL ? clickedFeatureSTL.properties.route_id : '';\n    const tripClickRTL = clickedFeatureRTL ? clickedFeatureRTL.properties.trip_id : '';\n\n    console.log(tripClickSTM);\n\n    // Dtermination du shape  faire apparatre en fonction du trip ou de la ligne cliqu.\n    const traceSTM = this.state.tracesSTM ? this.state.tracesSTM.features.filter((e) => {\n      return e.properties.trips.some((f) => {\n        return f === tripClickSTM\n      })\n    }) : ''\n\n    console.log(traceSTM);\n\n\n    const traceSTL = this.state.tracesSTL ? this.state.tracesSTL.features.filter((e) => {\n      return e.properties.route_short_name === routeClickSTL\n    }) : ''\n\n    const traceRTL = this.state.tracesRTL ? this.state.tracesRTL.features.filter((e) => {\n      return e.properties.trips.some((f) => {\n        return f === tripClickRTL\n      })\n    }) : ''\n\n\n    // Affichage de la trace\n    const clickTraceSTM = mapIsLoaded === true ? (tripClickSTM !== '' ? this.map.getSource(\"tracesSTM\").setData(traceSTM[0])\n      : this.map.getSource(\"tracesSTM\").setData(emptyGeoJSON))\n      : '';\n\n    const clickTraceSTL = mapIsLoaded === true ? (routeClickSTL !== '' ? this.map.getSource(\"tracesSTL\").setData(traceSTL[0])\n      : this.map.getSource(\"tracesSTL\").setData(emptyGeoJSON))\n      : '';\n\n    const clickTraceRTL = mapIsLoaded === true ? (tripClickRTL !== '' ? this.map.getSource(\"tracesRTL\").setData(traceRTL[0])\n      : this.map.getSource(\"tracesRTL\").setData(emptyGeoJSON))\n      : '';\n\n\n    //Requete pour obtenir les arrets a afficher selon le trip (ou la route)\n    const stopsSTM = tripClickSTM !== '' ? await this.stopRequestSTM(tripClickSTM) : '';\n    this.setState({ stopsSTM: stopsSTM })\n\n\n    const clickStopsSTM = mapIsLoaded === true ? (this.state.stopsSTM !== '' ? this.map.getSource(\"stopsSTM\").setData(this.state.stopsSTM)\n      : this.map.getSource(\"stopsSTM\").setData(emptyGeoJSON))\n      : '';\n\n    const stopsRTL = tripClickRTL !== '' ? await this.stopRequestRTL(tripClickRTL) : '';\n    this.setState({ stopsRTL: stopsRTL })\n\n\n    const clickStopsRTL = mapIsLoaded === true ? (this.state.stopsRTL !== '' ? this.map.getSource(\"stopsRTL\").setData(this.state.stopsRTL)\n      : this.map.getSource(\"stopsRTL\").setData(emptyGeoJSON))\n      : '';\n\n    const stopsSTL = routeClickSTL !== '' ? await this.stopRequestSTL(traceSTL[0].properties.ID) : '';\n    this.setState({ stopsSTL: stopsSTL })\n\n\n    const clickStopsSTL = mapIsLoaded === true ? (this.state.stopsSTL !== '' ? this.map.getSource(\"stopsSTL\").setData(this.state.stopsSTL)\n      : this.map.getSource(\"stopsSTL\").setData(emptyGeoJSON))\n      : '';\n\n\n    this.setState({\n      clickedFeatureSTM,\n      clickedFeatureSTL,\n      clickedFeatureRTL,\n      x: offsetX,\n      y: offsetY,\n    });\n\n  };\n\n\n  _renderTooltip() {\n\n    const {\n      hoveredFeatureSTM,\n      hoveredStopSTM,\n      hoveredFeatureSTL,\n      hoveredFeatureRTL,\n      hoveredFeatureEXO,\n      x, y, mapIsLoaded } = this.state;\n\n    // Identification du trip (stm, rtl) ou de la ligne (stl) hovered\n    const tripHoverSTM = hoveredFeatureSTM ? hoveredFeatureSTM.properties.trip_id : '';\n    const routeHoverSTL = hoveredFeatureSTL ? hoveredFeatureSTL.properties.route_id : '';\n    const tripHoverRTL = hoveredFeatureRTL ? hoveredFeatureRTL.properties.trip_id : '';\n    const tripHoverEXO = hoveredFeatureEXO ? hoveredFeatureEXO.properties.trip_id : '';\n\n    //Affectation du nom du trip ou de la ligne  une variable \n    const nomLigneSTM = this.state.tracesSTM ? this.state.tracesSTM.features.filter((e) => {\n      return e.properties.trips.some((f) => {\n        return f === tripHoverSTM\n      })\n    }) : ''\n\n    const nomLigneSTL = this.state.tracesSTL ? this.state.tracesSTL.features.filter((e) => {\n      return e.properties === routeHoverSTL\n    }) : ''\n\n    const nomLigneRTL = this.state.tracesRTL ? this.state.tracesRTL.features.filter((e) => {\n      return e.properties.trips.some((f) => {\n        return f === tripHoverRTL\n      })\n    }) : ''\n\n    const nomLigneEXO = this.state.tracesEXO ? this.state.tracesEXO.features.filter((e) => {\n      return e.properties.trips.some((f) => {\n        return f === tripHoverEXO\n      })\n    }) : ''\n\n\n\n    //AFFICHAGE DES TOOLTIP ON HOVER\n\n    return hoveredFeatureSTM ?\n      hoveredFeatureSTM && (\n        //ne pas appeler la class 'tooltip' car il semble que ce nom soit en conflit\n        //avec un autre tooltip...\n        <div className=\"mapToolTip\" style={{ left: x, top: y }}>\n          <div>Rseau: {hoveredFeatureSTM.properties.reseau}</div>\n          <div>Vhicule: {hoveredFeatureSTM.properties.vehicle_id}</div>\n          <div>Ligne: {hoveredFeatureSTM.properties.route_id}</div>\n          {/*<div>Axe: {nomLigneSTM[0].properties.route_name ? nomLigneSTM[0].properties.route_name : ''}</div>*/}\n          <div>Trip ID: {hoveredFeatureSTM.properties.trip_id}</div>\n          <div>Mise  jour: {hoveredFeatureSTM.properties.timestamp ? hoveredFeatureSTM.properties.timestamp : ''} s</div>\n        </div>\n      ) :\n      hoveredFeatureSTL ?\n        hoveredFeatureSTL && (\n          <div className=\"mapToolTip\" style={{ left: x, top: y }}>\n            <div>Rseau: {hoveredFeatureSTL.properties.reseau}</div>\n            <div>Vhicule: {hoveredFeatureSTL.properties.vehicle_id}</div>\n            <div>Ligne: {hoveredFeatureSTL.properties.route_id}</div>\n            <div>Mise  jour: {hoveredFeatureSTL.properties.last_connection} s</div>\n          </div>\n        ) :\n        hoveredFeatureRTL ?\n          hoveredFeatureRTL && (\n            <div className=\"mapToolTip\" style={{ left: x, top: y }}>\n              <div>Rseau: {hoveredFeatureRTL.properties.reseau}</div>\n              <div>Vhicule: {hoveredFeatureRTL.properties.vehicle_id}</div>\n              <div>Ligne: {hoveredFeatureRTL.properties.route_id}</div>\n              {/*<div>Axe: {nomLigneRTL ? nomLigneRTL[0].properties.route_name : ''}</div>*/}\n              <div>Trip ID: {hoveredFeatureRTL.properties.trip_id}</div>\n              <div>Mise  jour: {hoveredFeatureRTL.properties.timestamp ? hoveredFeatureRTL.properties.timestamp : ''} s</div>\n            </div>\n          ) :\n            hoveredFeatureEXO ?\n              hoveredFeatureEXO && (\n                <div className=\"mapToolTip\" style={{ left: x, top: y }}>\n                  <div>Rseau: {hoveredFeatureEXO.properties.cit}</div>\n                  <div>Vhicule: {hoveredFeatureEXO.properties.vehicle_id}</div>\n                  <div>Ligne: {hoveredFeatureEXO.properties.route_id}</div>\n                  {/*<div>Axe: {nomLigneRTL ? nomLigneRTL[0].properties.route_name : ''}</div>*/}\n                  <div>Trip ID: {hoveredFeatureEXO.properties.trip_id}</div>\n                  <div>Mise  jour: {hoveredFeatureEXO.properties.timestamp ? hoveredFeatureEXO.properties.timestamp : ''} s</div>\n                </div>\n              ) : ''\n    /*hoveredStopSTM ?\n      hoveredStopSTM && (\n        <div className=\"mapToolTip\" style={{ left: x, top: y }}>\n          <div>Passages :{this.hoveredStopSTM ? this.stopSTM.features.filter((e) => {\n            return e.id === parseInt(this.state.hoveredStopsSTM.id)\n          }).properties.departs.map((e) => { return e })\n            : ''}</div>\n        </div>\n      ) : ''*/\n\n  }\n\n\n  render() {\n\n    const { viewport } = this.state;\n\n    return <React.Fragment >\n      <div className=\"container-fluid\">\n        <StatCards\n          lastRefreshSTM={this.state.timestampSTM ? this.state.timestampSTM : '-'}\n          onlineVehiclesSTM={this.state.vehiclesSTM ? this.state.vehiclesSTM.features.length : 0}\n          plannedVehiclesSTM={this.state.plannedTripsSTM ? this.state.plannedTripsSTM.length : 0}\n          routesSTM={this.state.routesSTM ? this.state.routesSTM.length : 0}\n          lastRefreshSTL={this.state.timestampSTL ? this.state.timestampSTL : '-'}\n          onlineVehiclesSTL={this.state.vehiclesSTL ? this.state.vehiclesSTL.features.length : 0}\n          plannedVehiclesSTL={this.state.plannedTripsSTL ? this.state.plannedTripsSTL.length : 0}\n          routesSTL={this.state.routesSTL ? this.state.routesSTL.length : 0}\n          lastRefreshRTL={this.state.timestampRTL ? this.state.timestampRTL : '-'}\n          onlineVehiclesRTL={this.state.vehiclesRTL ? this.state.vehiclesRTL.features.length : 0}\n          plannedVehiclesRTL={this.state.plannedTripsRTL ? this.state.plannedTripsRTL.length : 0}\n          routesRTL={this.state.routesRTL ? this.state.routesRTL.length : 0}\n          lastRefreshEXO={this.state.timestampEXO ? this.state.timestampEXO : '-'}\n          onlineVehiclesEXO={this.state.vehiclesEXO ? this.state.vehiclesEXO.features.length : 0}\n          plannedVehiclesEXO={this.state.plannedTripsEXO ? this.state.plannedTripsEXO : 0}\n          routesEXO={this.state.routesEXO ? this.state.routesEXO.length : 0}\n        />\n        <MapGL\n          {...viewport}\n          ref={(reactMap) => this.reactMap = reactMap}\n          width=\"100%\"\n          height=\"85vh\"\n          mapStyle=\"mapbox://styles/wdoucetk/cjun8whio1ha21fmzxt8knp7k\"\n          onViewportChange={this._onViewportChange}\n          mapboxApiAccessToken={process.env.REACT_APP_MAPBOX_KEY}\n          onHover={this._onHover}\n          onClick={this._onClick}\n        >\n          {this._renderTooltip()}\n        </MapGL>\n      </div>\n    </React.Fragment >\n  }\n}\n\nexport default Livemap;\n\n//mapbox://styles/wdoucetk/cjun8whio1ha21fmzxt8knp7k light\n//mapbox://styles/wdoucetk/cjuc6i3960ggz1flfzzn3upav navigation","import React from 'react';\n\nimport {\n  ResponsiveContainer,\n  ScatterChart, Scatter, XAxis, YAxis, ZAxis, Tooltip\n} from 'recharts';\n\nconst turf = require('@turf/turf');\n\nexport async function calcGraphsTripsRTL(\n  visibleChartTripsLiveUpdate,\n  plannedTrips,\n  stops,\n  vehiclesRTL,\n  tracesRTL\n) {\n\n  let stopsCounter = 0;\n\n  // Pour chaque trip actif\n  visibleChartTripsLiveUpdate.forEach((e) => {\n\n    //Trouver la position du trip dans l'array de trips pour lesquels on affiche un graph\n    let tripIDS = [];\n    plannedTrips.map((f) => {\n      tripIDS.push(f.tripmin)\n    })\n\n    let position = tripIDS.indexOf(e)\n\n    //Trouver les arrts correspondants au trip\n    let stopsRTL = stops[stopsCounter].tripStops;\n    stopsCounter++;\n\n    //Prparer les donnes pour le graph\n    let data = [];\n    stopsRTL.features.map((f) => {\n      data.push({\n        name: f.properties.name,\n        time: f.properties.departure_time,\n        x: f.properties.stop_sequence,\n        y: 0,\n        z: 15\n      })\n    })\n\n    //Trouver les coordonnees actuelles du bus sur le trip\n    const currentPositionFeature = vehiclesRTL.features.filter((f) => {\n      return f.properties.trip_id === e\n    })[0].geometry.coordinates;\n\n    //Trouver la trace correspondant au trip\n    const traceRTL = tracesRTL.features.filter((f) => {\n      return f.properties.trips.some((g) => {\n        return g === e\n      })\n    })\n\n    //Trouver la distance parcourue par le bus sur le trip\n    const coordTrace = [];\n\n    traceRTL[0].geometry.coordinates.map((f) => {\n      coordTrace.push(f)\n    })\n\n    let turfLine = turf.lineString(coordTrace);\n    let pt = turf.point(currentPositionFeature);\n    let snapped = turf.nearestPointOnLine(turfLine, pt, { units: 'kilometers' });\n    let dist = [{ x: Math.round((snapped.properties.location) * 1000), y: 0, z: 60 }]\n\n    // Tooltip custom\n    const CustomTooltip = ({ active, payload }) => {\n      if (active) {\n        return (\n          <div className=\"custom-tooltip\">\n            <p className=\"label\">{payload[0].payload.name}<br />\n              Distance : {payload[0].payload.x}<br />\n              Planifi : {payload[0].payload.time}</p>\n          </div>\n        );\n      }\n      return null;\n    };\n\n    plannedTrips.splice(position + 1, 0, {\n      keyid: position + 1,\n      graph: 1,\n      online: plannedTrips[position].online,\n      timemin: parseInt(plannedTrips[position].timemin),\n      timemax: plannedTrips[position].timemax,\n      tripmin:\n        <ResponsiveContainer width=\"98%\" height={50} >\n          <ScatterChart>\n            <XAxis type=\"number\" dataKey=\"x\" hide />\n            <YAxis type=\"number\" dataKey=\"y\" hide />\n            <ZAxis type=\"number\" dataKey=\"z\" range={[10, 100]} domain={[15, 75]} />\n            <Tooltip\n              content={<CustomTooltip />}\n            />\n            <Scatter name=\"Arrets\" data={data} fill=\"#000000\" stroke=\"#5B5B5B\" line shape=\"circle\" />\n            <Scatter name=\"Bus\" data={dist} fill=\"#A93332\" shape=\"circle\" />\n          </ScatterChart>\n        </ResponsiveContainer >\n\n    })\n\n  })\n\n  //Affecter une cle unique correspondant a la position dans l'array\n  let keyID = 0;\n  plannedTrips.forEach((e) => {\n    e.keyid = keyID;\n    keyID++;\n  })\n\n  return plannedTrips\n\n}\n\n\n\n","import React from 'react';\n\nimport {\n  ResponsiveContainer,\n  ScatterChart, Scatter, XAxis, YAxis, ZAxis, Tooltip\n} from 'recharts';\n\nconst turf = require('@turf/turf');\n\nexport async function calcGraphsTripsSTM(\n  visibleChartTripsLiveUpdate,\n  plannedTrips,\n  stops,\n  vehiclesSTM,\n  tracesSTM\n) {\n\n  let stopsCounter = 0;\n\n  visibleChartTripsLiveUpdate.forEach((e) => {\n\n    //Trouver la position du trip dans l'array\n    let tripIDS = [];\n    plannedTrips.map((f) => {\n      tripIDS.push(f.tripmin)\n    })\n\n    let position = tripIDS.indexOf(e)\n\n    //Trouver les arrts correspondants au trip\n    let stopsSTM = stops[stopsCounter].tripStops;\n    stopsCounter++;\n\n    // Prparer les donnes pour le graph\n\n    // Etape supplementaire par rapport au RTL :\n\n    // La STM ne met pas les distances parcourues dans stop_sequence\n    // Il faut calculer la distance parcourue a chaque stop sur le trip avec turf\n\n    //Trouver la trace correspondant au trip\n    const traceSTM = tracesSTM.features.filter((f) => {\n      return f.properties.trips.some((g) => {\n        return g === e\n      })\n    })\n\n    const coordTrace = [];\n\n    traceSTM[0].geometry.coordinates.map((f) => {\n      coordTrace.push(f)\n    })\n\n    let turfLine = turf.lineString(coordTrace);\n\n    let stop_distances = [];\n\n    stopsSTM.features.forEach((f) => {\n      let pt = turf.point(f.geometry.coordinates);\n      let snapped = turf.nearestPointOnLine(turfLine, pt, { units: 'kilometers' });\n      let dist = Math.round((snapped.properties.location) * 1000);\n      stop_distances.push(dist)\n    })\n\n\n    let data = [];\n    let stopsequence = 0;\n    stopsSTM.features.map((f) => {\n      data.push({\n        name: f.properties.name,\n        time: f.properties.departure_time,\n        x: stop_distances[stopsequence],\n        y: 0,\n        z: 15\n      })\n      stopsequence++;\n    })\n\n    //Trouver les coordonnees actuelles du bus sur le trip\n    const currentPositionFeature = vehiclesSTM.features.filter((f) => {\n      return f.properties.trip_id === e\n    })[0].geometry.coordinates;\n\n\n    //Trouver la distance parcourue par le bus sur le trip\n    let pt = turf.point(currentPositionFeature);\n    let snapped = turf.nearestPointOnLine(turfLine, pt, { units: 'kilometers' });\n    let dist = [{ x: Math.round((snapped.properties.location) * 1000), y: 0, z: 60 }]\n\n    // Tooltip custom\n    const CustomTooltip = ({ active, payload }) => {\n      if (active) {\n        return (\n          <div className=\"custom-tooltip\">\n            <p className=\"label\">{payload[0].payload.name}<br />\n              Distance : {payload[0].payload.x}<br />\n              Planifi : {payload[0].payload.time}</p>\n          </div>\n        );\n      }\n      return null;\n    };\n\n\n    plannedTrips.splice(position + 1, 0, {\n      keyid: position + 1,\n      graph: 1,\n      online: plannedTrips[position].online,\n      timemin: parseInt(plannedTrips[position].timemin),\n      timemax: plannedTrips[position].timemax,\n      tripmin:\n        <ResponsiveContainer width=\"95%\" height={50} >\n          <ScatterChart>\n            <XAxis type=\"number\" dataKey=\"x\" hide />\n            <YAxis type=\"number\" dataKey=\"y\" hide />\n            <ZAxis type=\"number\" dataKey=\"z\" range={[10, 100]} domain={[15, 75]} />\n            <Tooltip\n              content={<CustomTooltip />}\n            />\n            <Scatter name=\"Arrets\" data={data} fill=\"#000000\" stroke=\"#5B5B5B\" line shape=\"circle\" />\n            <Scatter name=\"Bus\" data={dist} fill=\"#009DE0\" line shape=\"circle\" />\n          </ScatterChart>\n        </ResponsiveContainer >\n\n    })\n\n  })\n\n\n\n  //Affecter une cle unique correspondant a la position dans l'array\n  let keyID = 0;\n  plannedTrips.forEach((e) => {\n    e.keyid = keyID;\n    keyID++;\n  })\n\n  return plannedTrips\n\n}\n\n","import React, { Component } from 'react';\nimport ReactLoading from 'react-loading';\n\nimport {\n  getNewData, leave,\n  getTracesSTM, getTracesSTL, getTracesRTL,\n  getStopsSTM, getStopsRTL, getStopsSTL\n} from '../API.js';\n\nimport { calcGraphsTripsRTL } from '../helpers/tripsRTL.js';\nimport { calcGraphsTripsSTM } from '../helpers/tripsSTM.js';\n\nconst moment = require('moment');\n\nclass Livetrips extends Component {\n\n  state = {\n    tripList: [],\n    selectStops: [],\n    selectSTM: 0,\n    selectSTL: 0,\n    selectRTL: 0,\n  };\n\n  componentDidMount = async () => {\n\n    const getData = getNewData((err, positions) => {\n\n      // Split data by network\n\n      const vehSTM = positions ? positions[0].filter((e) => {\n        return e.reseau === 'STM'\n      }) : ''\n\n      const vehSTL = positions ? positions[0].filter((e) => {\n        return e.reseau === 'STL'\n      }) : ''\n\n      const vehRTL = positions ? positions[0].filter((e) => {\n        return e.reseau === 'RTL'\n      }) : ''\n\n      // Add 'online' property when planned trip matches live data\n      // Allows to color trip with green/red depending on property\n\n      let keyIDRTL = 0;\n      const checkOnlineRTL = positions[1].forEach((e) => {\n        e.keyid = keyIDRTL;\n        keyIDRTL++;\n        if (vehRTL[0].data.features.filter((f) => {\n          return f.properties.trip_id === e.tripmin\n        }).length > 0) {\n          e.online = 1\n        } else {\n          e.online = 0\n        }\n      })\n\n      // No trip ID in STL data\n      // To Do : find a way to match live trips to planned gtfs data\n\n      let keyIDSTM = 0;\n      const checkOnlineSTM = positions[3].forEach((e) => {\n        e.keyid = keyIDSTM;\n        keyIDSTM++;\n        if (vehSTM[0].data.features.filter((f) => {\n          return f.properties.trip_id === e.tripmin\n        }).length > 0) {\n          e.online = 1\n        } else {\n          e.online = 0\n        }\n      })\n\n\n      this.setState({\n        vehiclesSTM: positions ? vehSTM[0].data : '',\n        vehiclesSTL: positions ? vehSTL[0].data : '',\n        vehiclesRTL: positions ? vehRTL[0].data : '',\n        timestampSTM: positions ? vehSTM[0].time : '',\n        timestampSTL: positions ? vehSTL[0].time : '',\n        timestampRTL: positions ? vehSTL[0].time : '',\n        plannedTripsRTL: positions ? positions[1] : '',\n        plannedTripsSTL: positions ? positions[2].sort((a, b) => (a.timemin > b.timemin) ? 1 : -1) : '',\n        plannedTripsSTM: positions ? positions[3] : ''\n      })\n\n      //plannedTripsRTL: positions ? positions[1].sort((a, b) => (a.timemin > b.timemin) ? 1 : -1) : ''\n\n    })\n\n\n    const tracesRTL = await getTracesRTL();\n    this.setState({\n      tracesRTL: tracesRTL.rows[0].jsonb_build_object\n    })\n\n    const tracesSTM = await getTracesSTM();\n    this.setState({\n      tracesSTM: tracesSTM.rows[0].jsonb_build_object\n    })\n\n\n    if (this.state.selectRTL === 1 && this.state.plannedTripsRTL) {\n      this.regenGraphRTL();\n    }\n\n    if (this.state.selectSTM === 1 && this.state.plannedTripsSTM) {\n      this.regenGraphSTM();\n    }\n\n  }\n\n\n  componentDidUpdate(prevProps, prevState) {\n\n    const { tripList, plannedTripsRTL, plannedTripsSTM, selectRTL, selectSTM } = this.state;\n\n\n    if (selectRTL === 1 && plannedTripsRTL !== prevState.plannedTripsRTL) {\n      this.regenGraphRTL();\n    }\n\n    if (selectRTL === 1 && tripList.length !== prevState.tripList.length) {\n      this.regenGraphRTL();\n    }\n\n\n    if (selectSTM === 1 && plannedTripsSTM !== prevState.plannedTripsSTM) {\n      this.regenGraphSTM();\n    }\n\n    if (selectSTM === 1 && tripList.length !== prevState.tripList.length) {\n      this.regenGraphSTM();\n    }\n\n    //console.log(this.state)\n\n  }\n\n\n  componentWillUnmount = async () => {\n    leave();\n  }\n\n\n  handleClickSTM = async (e) => {\n    this.setState({\n      selectSTM: 1,\n      selectSTL: 0,\n      selectRTL: 0,\n      tripList: [],\n      selectStops: [],\n      plannedTripsWithGraphs: []\n    })\n  }\n\n  handleClickRTL = async (e) => {\n    this.setState({\n      selectSTM: 0,\n      selectSTL: 0,\n      selectRTL: 1,\n      tripList: [],\n      selectStops: [],\n      plannedTripsWithGraphs: []\n    })\n  }\n\n  stopRequestRTL = async (trip) => {\n    const stopsResponseRTL = await getStopsRTL(trip);\n    const parseStopsRTL = stopsResponseRTL.rows[0].jsonb_build_object\n    return parseStopsRTL\n  }\n\n  stopRequestSTM = async (trip) => {\n    const stopsResponseSTM = await getStopsSTM(trip);\n    const parseStopsSTM = stopsResponseSTM.rows[0].jsonb_build_object\n    return parseStopsSTM\n  }\n\n\n\n  regenGraphRTL = async () => {\n\n    let visibleChartTrips = [...this.state.tripList];\n\n    // Get stops info --only if it has not been fetched yet\n    // async/await fetch can't be included in forEach\n    // has to be in for...of\n\n    let stops = [...this.state.selectStops];\n\n    for (const e of visibleChartTrips) {\n      if (stops.filter((f) => { return f.tripID === e }).length === 0) {\n        let tripStops = await this.stopRequestRTL(e);\n        stops.push({\n          tripID: e,\n          tripStops: tripStops\n        });\n      }\n    }\n\n    let plannedTrips = [...this.state.plannedTripsRTL];\n\n    // AutoRemove planned trips that are not in the current time window\n\n    //** TODO: if trip not in current time window but still online, means\n    //bus is late. Trip should not be autoremoved.\n\n    let visibleChartTripsUpdate = [];\n    const autoRemove = this.state.tripList.length > 0 ?\n      this.state.tripList.forEach((e) => {\n        if (this.state.plannedTripsRTL.filter((f) => {\n          return e === f.tripmin\n        }).length > 0) {\n          visibleChartTripsUpdate.push(e)\n        }\n      }) :\n      '';\n\n    // AutoRemove trips that are not online anymore\n\n    let visibleChartTripsLiveUpdate = [];\n    const autoRemoveLive = visibleChartTripsUpdate.length > 0 ?\n      visibleChartTripsUpdate.forEach((e) => {\n        if (this.state.vehiclesRTL.features.filter((f) => {\n          return f.properties.trip_id === e\n        }).length > 0) {\n          visibleChartTripsLiveUpdate.push(e)\n        }\n      }) :\n      '';\n\n    let vehiclesRTL = this.state.vehiclesRTL;\n    let tracesRTL = this.state.tracesRTL;\n\n    // Calcul des graphs\n    plannedTrips = await calcGraphsTripsRTL(\n      visibleChartTripsLiveUpdate,\n      plannedTrips,\n      stops,\n      vehiclesRTL,\n      tracesRTL\n    );\n\n    this.setState({\n      plannedTripsWithGraphs: plannedTrips,\n      tripList: visibleChartTripsLiveUpdate,\n      selectStops: stops\n    })\n\n  }\n\n\n\n  regenGraphSTM = async () => {\n\n    let visibleChartTrips = [...this.state.tripList];\n\n    // Get stops info --only if it has not been fetched yet\n    // async/await fetch can't be included in forEach\n    // has to be in for...of\n\n    let stops = [...this.state.selectStops];\n\n    for (const e of visibleChartTrips) {\n      if (stops.filter((f) => { return f.tripID === e }).length === 0) {\n        let tripStops = await this.stopRequestSTM(e);\n        stops.push({\n          tripID: e,\n          tripStops: tripStops\n        });\n      }\n    }\n\n    let plannedTrips = [...this.state.plannedTripsSTM];\n\n    // AutoRemove planned trips that are not in the current time window\n\n    //**TO DO : if trip not in current time window but still online, means\n    //bus is late. Trip should not be autoremoved.\n\n    let visibleChartTripsUpdate = [];\n    const autoRemove = this.state.tripList.length > 0 ?\n      this.state.tripList.forEach((e) => {\n        if (this.state.plannedTripsSTM.filter((f) => {\n          return e === f.tripmin\n        }).length > 0) {\n          visibleChartTripsUpdate.push(e)\n        }\n      }) :\n      '';\n\n    // AutoRemove trips that are not online anymore\n\n    let visibleChartTripsLiveUpdate = [];\n    const autoRemoveLive = visibleChartTripsUpdate.length > 0 ?\n      visibleChartTripsUpdate.forEach((e) => {\n        if (this.state.vehiclesSTM.features.filter((f) => {\n          return f.properties.trip_id === e\n        }).length > 0) {\n          visibleChartTripsLiveUpdate.push(e)\n        }\n      }) :\n      '';\n\n    let vehiclesSTM = this.state.vehiclesSTM;\n    let tracesSTM = this.state.tracesSTM;\n\n    // Prepare graphs\n    plannedTrips = await calcGraphsTripsSTM(\n      visibleChartTripsLiveUpdate,\n      plannedTrips,\n      stops,\n      vehiclesSTM,\n      tracesSTM\n    );\n\n    this.setState({\n      plannedTripsWithGraphs: plannedTrips,\n      tripList: visibleChartTripsLiveUpdate,\n      selectStops: stops\n    })\n\n  }\n\n\n  addToTripList = async (e) => {\n    let tripListAdd = [...this.state.tripList];\n    tripListAdd.push(e);\n    this.setState({ tripList: tripListAdd })\n  }\n\n\n  removeFromTripList = async (e) => {\n    let tripListRemove = [...this.state.tripList];\n    let tripPosition = tripListRemove.indexOf(e);\n    tripListRemove.splice(tripPosition, 1)\n\n    let stopListRemove = [...this.state.selectStops];\n    stopListRemove.splice(tripPosition, 1)\n\n    this.setState({\n      tripList: tripListRemove,\n      selectStops: stopListRemove\n    })\n  }\n\n\n  handleTripClickRTL = async (e) => {\n\n    //if trip is online and graph not showing\n    //add trip to list\n\n    //if trip is online and graph showing\n    //remove trip from list\n\n    const showhide = this.state.plannedTripsRTL.filter((f) => {\n      return f.tripmin === e.target.innerHTML\n    })[0].online === 1 &&\n      this.state.tripList.filter((f) => {\n        return f === e.target.innerHTML\n      }).length === 0 ?\n      this.addToTripList(e.target.innerHTML) :\n      this.state.plannedTripsRTL.filter((f) => {\n        return f.tripmin === e.target.innerHTML\n      })[0].online === 1 &&\n        this.state.tripList.filter((f) => {\n          return f === e.target.innerHTML\n        }).length > 0 ?\n        this.removeFromTripList(e.target.innerHTML)\n        : ''\n\n  }\n\n\n  handleTripClickSTM = async (e) => {\n\n    const showhide = this.state.plannedTripsSTM.filter((f) => {\n      return f.tripmin === e.target.innerHTML\n    })[0].online === 1 &&\n      this.state.tripList.filter((f) => {\n        return f === e.target.innerHTML\n      }).length === 0 ?\n      this.addToTripList(e.target.innerHTML) :\n      this.state.plannedTripsSTM.filter((f) => {\n        return f.tripmin === e.target.innerHTML\n      })[0].online === 1 &&\n        this.state.tripList.filter((f) => {\n          return f === e.target.innerHTML\n        }).length > 0 ?\n        this.removeFromTripList(e.target.innerHTML)\n        : ''\n\n  }\n\n\n  render() {\n\n    return (\n      this.state.plannedTripsSTM ?\n        <div className=\"container-fluid\">\n\n          <div className=\"row\">\n            <div className=\"col-sm\">\n              <h1 id=\"title-card\" className=\"display-4\">Vue linaire : par voyage</h1>\n            </div>\n          </div>\n          <div className=\"row justify-content-center\">\n            <div className=\"col-sm-4 mt-2 mb-2\" style={{ textAlign: \"center\", backgroundColor: \"#E1FFE1\" }}>\n              Voyage planifi actif\n            </div>\n            <div className=\"col-sm-4 mt-2 mb-2\" style={{ textAlign: \"center\", backgroundColor: \"#FFE2E2\" }}>\n              Voyage planifi inactif\n            </div>\n          </div>\n\n          <div className=\"row no-gutters\">\n            <div className=\"col\">\n              <button\n                id=\"agency-card\"\n                type=\"button\" className=\"col btn btn-outline-info\"\n                style={this.state.selectSTM === 1 ?\n                  { backgroundColor: \"#38B2A3\", color: \"#FFFFFF\" } :\n                  { backgroundColor: \"#E9F1F3\", color: \"#000000\" }}\n                onClick={(e) => this.handleClickSTM(e)}>\n                STM\n            </button>\n            </div>\n            <div className=\"col\">\n              <button type=\"button\" className=\"col btn btn-outline-secondary\" disabled>\n                STL\n            </button>\n            </div>\n            <div className=\"col\">\n              <button\n                type=\"button\" className=\"col btn btn-outline-info\"\n                style={this.state.selectRTL === 1 ?\n                  { backgroundColor: \"#38B2A3\", color: \"#FFFFFF\" } :\n                  { backgroundColor: \"#E9F1F3\", color: \"#000000\" }}\n                onClick={(e) => this.handleClickRTL(e)}>\n                RTL\n            </button>\n            </div>\n          </div>\n\n\n          <div className=\"row\">\n            <div className=\"col\">\n              <table id=\"tableOnline\" className=\"table\">\n                <thead>\n                  <tr>\n                    <th style={{ width: \"7.5%\" }}>\n                      Ligne\n                  </th>\n                    <th style={{ width: \"7.5%\" }}>\n                      Direction\n                  </th>\n                    <th style={{ width: \"7.5%\" }}>\n                      Dpart\n                  </th>\n                    <th style={{ width: \"7.5%\" }}>\n                      Arrive\n                  </th>\n                    <th style={{ width: \"70%\" }}>\n                      Trip ID\n                  </th>\n                  </tr>\n                </thead>\n                <tbody>\n                  {this.state.selectRTL === 1 && this.state.plannedTripsWithGraphs.length > 0 ? this.state.plannedTripsWithGraphs.map((e) => e.graph === undefined ? (\n                    <tr\n                      key={e.keyid}\n                      style={{\n                        backgroundColor: e.online === 1 ? \"#E1FFE1\" : \"#FFE2E2\"\n                      }}>\n                      <td>{e.route_id}</td>\n                      <td>{e.direction_id === 1 ? 'Centre-Ville' : 'Priphrie'}</td>\n                      <td>{moment(\"2019-05-10\").startOf('day').seconds(e.timemin).format('H:mm:ss')}</td>\n                      <td>{moment(\"2019-05-10\").startOf('day').seconds(e.timemax).format('H:mm:ss')}</td>\n                      <td\n                        style={{\n                          cursor: e.online === 1 ? 'pointer' : 'default'\n                        }}\n                        onClick={(event) => this.handleTripClickRTL(event)}\n                      >\n                        {e.tripmin}\n                      </td>\n                    </tr>\n                  ) : <tr key={e.keyid}>\n                      <td\n                        colSpan=\"5\"\n                        style={{ backgroundColor: \"#FFFFFF\" }} >\n                        {e.tripmin}\n                      </td>\n                    </tr>) : this.state.selectRTL === 1 && this.state.plannedTripsWithGraphs.length === 0 ?\n                      <tr>\n                        <td colSpan=\"5\" style={{ textAlign: \"center\" }}>\n                          <ReactLoading type={\"bubbles\"} color={\"#277D98\"} height={200} width={100} />\n                        </td>\n                      </tr> :\n                      this.state.selectSTM === 1 && this.state.plannedTripsWithGraphs.length > 0 ? this.state.plannedTripsWithGraphs.map((e) => e.graph === undefined ? (\n                        <tr\n                          key={e.keyid}\n                          style={{\n                            backgroundColor: e.online === 1 ? \"#E1FFE1\" : \"#FFE2E2\"\n                          }}>\n                          <td>{e.route_id}</td>\n                          <td>{e.direction_id}</td>\n                          <td>{moment(\"2019-05-10\").startOf('day').seconds(e.timemin).format('H:mm:ss')}</td>\n                          <td>{moment(\"2019-05-10\").startOf('day').seconds(e.timemax).format('H:mm:ss')}</td>\n                          <td\n                            style={{\n                              cursor: e.online === 1 ? 'pointer' : 'default'\n                            }}\n                            onClick={(event) => this.handleTripClickSTM(event)}\n                          >\n                            {e.tripmin}\n                          </td>\n                        </tr>\n                      ) : <tr key={e.keyid}>\n                          <td\n                            colSpan=\"5\"\n                            style={{ backgroundColor: \"#FFFFFF\" }} >\n                            {e.tripmin}\n                          </td>\n                        </tr>) :\n                        this.state.selectSTM === 1 && this.state.plannedTripsWithGraphs.length === 0 ?\n                          <tr>\n                            <td colSpan=\"4\" style={{ textAlign: \"center\" }}>\n                              <ReactLoading type={\"bubbles\"} color={\"#277D98\"} height={200} width={100} />\n                            </td>\n                          </tr> :\n                          <tr>\n                            <td colSpan=\"5\" style={{ textAlign: \"center\" }}> Slectionner une agence</td>\n                          </tr>}\n                </tbody>\n              </table>\n            </div>\n          </div>\n        </div >\n        : <div className=\"container\">\n          <div className=\"row justify-content-center\">Chargement en cours...</div>\n          <div className=\"row justify-content-center\">\n            <div><ReactLoading type={\"bars\"} color={\"#277D98\"} height={300} width={175} /></div>\n          </div>\n        </div>\n    )\n  }\n}\n\nexport default Livetrips;","import React from 'react';\n\nimport {\n  ResponsiveContainer,\n  ScatterChart, Scatter, XAxis, YAxis, ZAxis, Tooltip\n} from 'recharts';\n\nconst turf = require('@turf/turf');\n\n\n// Get unique routes-directions\n\nexport function longestRoutesRTL(plannedTripsRTL) {\n\n  //TODO: une ligne qui a des trips online et des trips offline devrait\n  // automatiquement eliminer les trips offline pour le choix du trip pour les arrets\n\n  let ligneDir = [];\n  plannedTripsRTL.map((e) => {\n    ligneDir.push({\n      keyid: e.keyid,\n      route_id: e.route_id,\n      direction_id: e.direction_id,\n      ligneDir: e.route_id + '_' + e.direction_id,\n      online: e.online,\n      stopcount: e.stopcount\n    })\n  })\n\n  let ligneDirOnline = ligneDir.filter((e) => {\n    return e.online === 1\n  })\n\n  let uniqueRoutes = Array.from(new Set(ligneDirOnline.map(e => e.ligneDir)))\n    .map(f => {\n      return {\n        ligneDir: f,\n        keyid: ligneDir.find(s => s.ligneDir === f).keyid,\n        route_id: ligneDir.find(s => s.ligneDir === f).route_id,\n        direction_id: ligneDir.find(s => s.ligneDir === f).direction_id,\n        online: ligneDir.find(s => s.ligneDir === f).online\n      }\n    })\n\n  return uniqueRoutes\n}\n\n\n// Regen routes graph\n\nexport function regenGraphRoutesRTL(\n  routeList,\n  tripList,\n  visibleChartRoutes,\n  stops,\n  vehiclesRTL,\n  tracesRTL) {\n\n  let stopsCounter = 0;\n\n  routeList.forEach((e) => {\n\n    // Tous les trips de la ligne direction qui sont online\n    let tripsLigneDir = tripList.filter((f) => {\n      return f.ligneDir === e && f.online === 1\n    })\n\n    //console.log(tripsLigneDir)\n\n    // Trouver la position de la route dans l'array de routes pour lesquels on affiche un graph\n    let routeIDS = [];\n    visibleChartRoutes.map((f) => {\n      routeIDS.push(f.ligneDir)\n    })\n\n    let position = routeIDS.indexOf(e)\n\n    let stopsRTL = stops[stopsCounter].tripStops;\n    stopsCounter++;\n\n    // Creer l'array d'arrets selon la trace identifiee\n    let data = [];\n    stopsRTL.features.map((f) => {\n      data.push({\n        name: f.properties.name,\n        time: f.properties.departure_time,\n        x: f.properties.stop_sequence,\n        y: 0,\n        z: 15\n      })\n    })\n\n    // Preparation du calcul des positions des vehicules sur la ligne-direction\n    let distArray = [];\n\n    tripsLigneDir.forEach((k) => {\n      //Trouver les coordonnees actuelles du bus sur le trip\n\n      const currentPositionFeature = vehiclesRTL.features.filter((f) => {\n        return f.properties.trip_id === k.tripmin\n      })[0].geometry.coordinates;\n\n      //Trouver la trace correspondant au trip\n      const traceRTL = tracesRTL.features.filter((f) => {\n        return f.properties.trips.some((g) => {\n          return g === k.tripmin\n        })\n      })\n\n      //Trouver la distance parcourue par le bus sur le trip\n      const coordTrace = [];\n\n      traceRTL[0].geometry.coordinates.map((f) => {\n        coordTrace.push(f)\n      })\n\n      let turfLine = turf.lineString(coordTrace);\n      let pt = turf.point(currentPositionFeature);\n      let snapped = turf.nearestPointOnLine(turfLine, pt, { units: 'kilometers' });\n      let dist = { x: Math.round((snapped.properties.location) * 1000), y: 0, z: 60 }\n\n      distArray.push(dist);\n    })\n\n    const CustomTooltip = ({ active, payload }) => {\n      if (active) {\n        return (\n          <div className=\"custom-tooltip\">\n            <p className=\"label\">{payload[0].payload.name}<br />\n              Distance : {payload[0].payload.x}<br />\n            </p>\n          </div>\n        );\n      }\n      return null;\n    };\n\n    // si jamais le graph se regenere, c'est parce qu'on utilise pas la meme source entre le premier render\n    // et les suivants. Pour s'assurer qu'il ne se regenere pas plusieurs fois, utiliser la meme source dans\n    // le state initial et dans les setState suivants\n    visibleChartRoutes.splice(position + 1, 0, {\n      keyid: position + 1,\n      graph: 1,\n      ligneDir: 'graph',\n      tripmin:\n        <ResponsiveContainer width=\"98%\" height={50} >\n          <ScatterChart>\n            <XAxis type=\"number\" dataKey=\"x\" hide />\n            <YAxis type=\"number\" dataKey=\"y\" hide />\n            <ZAxis type=\"number\" dataKey=\"z\" range={[10, 100]} domain={[15, 75]} />\n            <Tooltip\n              content={<CustomTooltip />}\n            />\n            <Scatter name=\"Arrets\" data={data} fill=\"#000000\" stroke=\"#5B5B5B\" line shape=\"circle\" />\n            <Scatter name=\"Bus\" data={distArray} fill=\"#A93332\" shape=\"circle\" />\n          </ScatterChart>\n        </ResponsiveContainer>\n\n    })\n\n  })\n\n  return visibleChartRoutes\n\n}\n\n\n\n\n\n\n","import React from 'react';\n\nimport {\n  ResponsiveContainer,\n  ScatterChart, Scatter, XAxis, YAxis, ZAxis, Tooltip\n} from 'recharts';\nimport { debug } from 'util';\n\nconst turf = require('@turf/turf');\n\n\n// Get unique routes-directions\n\nexport function longestRoutesSTM(plannedTripsSTM) {\n\n  //TODO: une ligne qui a des trips online et des trips offline devrait\n  // automatiquement eliminer les trips offline pour le choix du trip pour les arrets\n\n  let ligneDir = [];\n  plannedTripsSTM.map((e) => {\n    ligneDir.push({\n      keyid: e.keyid,\n      route_id: e.route_id,\n      direction_id: e.direction_id,\n      ligneDir: e.route_id + '_' + e.direction_id,\n      online: e.online,\n      stopcount: e.stopcount,\n      trip_id: e.tripmin\n    })\n  })\n\n  let ligneDirOnline = ligneDir.filter((e) => {\n    return e.online === 1\n  })\n\n  let uniqueRoutes = Array.from(new Set(ligneDirOnline.map(e => e.ligneDir)))\n    .map(f => {\n      return {\n        ligneDir: f,\n        keyid: ligneDir.find(s => s.ligneDir === f).keyid,\n        route_id: ligneDir.find(s => s.ligneDir === f).route_id,\n        direction_id: ligneDir.find(s => s.ligneDir === f).direction_id,\n        online: ligneDir.find(s => s.ligneDir === f).online\n      }\n    })\n\n  return uniqueRoutes\n}\n\n\n// Regen routes graph\n\nexport function regenGraphRoutesSTM(\n  routeList,\n  tripList,\n  visibleChartRoutes,\n  stops,\n  vehiclesSTM,\n  tracesSTM) {\n\n  let stopsCounter = 0;\n\n  routeList.forEach((e) => {\n\n    // Tous les trips de la ligne direction qui sont online\n    let tripsLigneDir = tripList.filter((f) => {\n      return f.ligneDir === e && f.online === 1\n    })\n\n    //console.log(tripsLigneDir)\n\n    // Trouver la position de la route dans l'array de routes pour lesquels on affiche un graph\n    let routeIDS = [];\n    visibleChartRoutes.map((f) => {\n      routeIDS.push(f.ligneDir)\n    })\n\n    let position = routeIDS.indexOf(e)\n\n    let stopsSTM = stops[stopsCounter].tripStops;\n\n    // Etape supplementaire par rapport au RTL :\n\n    // La STM ne met pas les distances parcourues dans stop_sequence\n    // Il faut calculer la distance parcourue a chaque stop sur le trip avec turf\n    //Trouver la trace correspondant au trip\n    const traceSTM = tracesSTM.features.filter((f) => {\n      return f.properties.trips.some((g) => {\n        return g === stops[stopsCounter].tripID\n      })\n    })\n\n    stopsCounter++;\n    const coordTrace = [];\n\n    traceSTM[0].geometry.coordinates.map((f) => {\n      coordTrace.push(f)\n    })\n\n    let turfLine = turf.lineString(coordTrace);\n\n    let stop_distances = [];\n\n    stopsSTM.features.forEach((f) => {\n      let pt = turf.point(f.geometry.coordinates);\n      let snapped = turf.nearestPointOnLine(turfLine, pt, { units: 'kilometers' });\n      let dist = Math.round((snapped.properties.location) * 1000);\n      stop_distances.push(dist)\n    })\n\n\n    // Creer l'array d'arrets selon la trace identifiee\n    let data = [];\n    let stopsequence = 0;\n    stopsSTM.features.map((f) => {\n      data.push({\n        name: f.properties.name,\n        time: f.properties.departure_time,\n        x: stop_distances[stopsequence],\n        y: 0,\n        z: 15\n      })\n      stopsequence++;\n    })\n\n    // Preparation du calcul des positions des vehicules sur la ligne-direction\n    let distArray = [];\n\n    tripsLigneDir.forEach((k) => {\n      //Trouver les coordonnees actuelles du bus sur le trip\n\n      const currentPositionFeature = vehiclesSTM.features.filter((f) => {\n        return f.properties.trip_id === k.tripmin\n      })[0].geometry.coordinates;\n\n      //Trouver la trace correspondant au trip\n      const traceSTM = tracesSTM.features.filter((f) => {\n        return f.properties.trips.some((g) => {\n          return g === k.tripmin\n        })\n      })\n\n      //Trouver la distance parcourue par le bus sur le trip\n      const coordTrace = [];\n\n      traceSTM[0].geometry.coordinates.map((f) => {\n        coordTrace.push(f)\n      })\n\n      let turfLine = turf.lineString(coordTrace);\n      let pt = turf.point(currentPositionFeature);\n      let snapped = turf.nearestPointOnLine(turfLine, pt, { units: 'kilometers' });\n      let dist = { x: Math.round((snapped.properties.location) * 1000), y: 0, z: 60 }\n\n      distArray.push(dist);\n    })\n\n    const CustomTooltip = ({ active, payload }) => {\n      if (active) {\n        return (\n          <div className=\"custom-tooltip\">\n            <p className=\"label\">{payload[0].payload.name}<br />\n              Distance : {payload[0].payload.x}<br />\n            </p>\n          </div>\n        );\n      }\n      return null;\n    };\n\n    // si jamais le graph se regenere, c'est parce qu'on utilise pas la meme source entre le premier render\n    // et les suivants. Pour s'assurer qu'il ne se regenere pas plusieurs fois, utiliser la meme source dans\n    // le state initial et dans les setState suivants\n    visibleChartRoutes.splice(position + 1, 0, {\n      keyid: position + 1,\n      graph: 1,\n      ligneDir: 'graph',\n      tripmin:\n        <ResponsiveContainer width=\"98%\" height={50} >\n          <ScatterChart>\n            <XAxis type=\"number\" dataKey=\"x\" hide />\n            <YAxis type=\"number\" dataKey=\"y\" hide />\n            <ZAxis type=\"number\" dataKey=\"z\" range={[10, 100]} domain={[15, 75]} />\n            <Tooltip\n              content={<CustomTooltip />}\n            />\n            <Scatter name=\"Arrets\" data={data} fill=\"#000000\" stroke=\"#5B5B5B\" line shape=\"circle\" />\n            <Scatter name=\"Bus\" data={distArray} fill=\"#009DE0\" shape=\"circle\" />\n          </ScatterChart>\n        </ResponsiveContainer>\n\n    })\n\n  })\n\n  return visibleChartRoutes\n\n}\n\n\n\n\n\n\n","import React, { Component } from 'react';\nimport ReactLoading from 'react-loading';\n\nimport {\n  getNewData, leave,\n  getTracesSTM, getTracesSTL, getTracesRTL,\n  getStopsSTM, getStopsRTL, getStopsSTL\n} from '../API.js';\n\nimport { longestRoutesRTL, regenGraphRoutesRTL } from '../helpers/routesRTL.js';\nimport { longestRoutesSTM, regenGraphRoutesSTM } from '../helpers/routesSTM.js';\n\n\nclass Liveroutes extends Component {\n\n  state = {\n    routeList: [],\n    selectStops: [],\n    plannedRoutesWithGraphs: [],\n    selectSTM: 0,\n    selectSTL: 0,\n    selectRTL: 0,\n  };\n\n  componentDidMount = async () => {\n\n    const tracesRTL = await getTracesRTL();\n\n    const tracesSTM = await getTracesSTM();\n\n    const getData = getNewData((err, positions) => {\n\n      // Split data by network\n\n      const vehSTM = positions ? positions[0].filter((e) => {\n        return e.reseau === 'STM'\n      }) : ''\n\n      const vehSTL = positions ? positions[0].filter((e) => {\n        return e.reseau === 'STL'\n      }) : ''\n\n      const vehRTL = positions ? positions[0].filter((e) => {\n        return e.reseau === 'RTL'\n      }) : ''\n\n      // Add 'online' property when planned trip matches live data\n      // Allows to color trip with green/red depending on property\n\n      let keyIDRTL = 0;\n      const checkOnlineRTL = positions[1].forEach((e) => {\n        e.keyid = keyIDRTL;\n        e.ligneDir = e.route_id + '_' + e.direction_id\n        keyIDRTL++;\n        if (vehRTL[0].data.features.filter((f) => {\n          return f.properties.trip_id === e.tripmin\n        }).length > 0) {\n          e.online = 1\n        } else {\n          e.online = 0\n        }\n      })\n\n      // get unique routes\n      const completeTracesRTL = longestRoutesRTL(positions[1])\n\n      // No trip ID in STL data\n      // To Do : find a way to match live trips to planned gtfs data\n\n      let keyIDSTM = 0;\n      const checkOnlineSTM = positions[3].forEach((e) => {\n        e.keyid = keyIDSTM;\n        e.ligneDir = e.route_id + '_' + e.direction_id\n        keyIDSTM++;\n        if (vehSTM[0].data.features.filter((f) => {\n          return f.properties.trip_id === e.tripmin\n        }).length > 0) {\n          e.online = 1\n        } else {\n          e.online = 0\n        }\n      })\n\n      // get unique routes\n      const completeTracesSTM = longestRoutesSTM(positions[3])\n\n\n      this.setState({\n        vehiclesSTM: positions ? vehSTM[0].data : '',\n        vehiclesSTL: positions ? vehSTL[0].data : '',\n        vehiclesRTL: positions ? vehRTL[0].data : '',\n        timestampSTM: positions ? vehSTM[0].time : '',\n        timestampSTL: positions ? vehSTL[0].time : '',\n        timestampRTL: positions ? vehSTL[0].time : '',\n        plannedTripsRTL: positions ? positions[1] : '',\n        plannedTripsSTL: positions ? positions[2].sort((a, b) => (a.timemin > b.timemin) ? 1 : -1) : '',\n        plannedTripsSTM: positions ? positions[3] : '',\n        plannedRoutesRTL: completeTracesRTL,\n        plannedRoutesSTM: completeTracesSTM,\n        tracesRTL: tracesRTL.rows[0].jsonb_build_object,\n        tracesSTM: tracesSTM.rows[0].jsonb_build_object\n      })\n\n      //plannedTripsRTL: positions ? positions[1].sort((a, b) => (a.timemin > b.timemin) ? 1 : -1) : ''\n\n    })\n\n    if (this.state.selectRTL === 1 && this.state.plannedRoutesRTL) {\n      this.regenGraphRoutesRTL();\n    }\n\n    if (this.state.selectSTM === 1 && this.state.plannedRoutesSTM) {\n      this.regenGraphRoutesSTM();\n    }\n\n\n  }\n\n\n  componentDidUpdate(prevProps, prevState) {\n\n    const { routeList, plannedRoutesRTL, plannedRoutesSTM, selectRTL, selectSTM } = this.state;\n\n    if (selectRTL === 1 && routeList.length !== prevState.routeList.length) {\n      this.regenGraphRoutesRTL();\n    }\n\n    if (selectRTL === 1 && plannedRoutesRTL !== prevState.plannedRoutesRTL) {\n      this.regenGraphRoutesRTL();\n    }\n\n    if (selectSTM === 1 && routeList.length !== prevState.routeList.length) {\n      this.regenGraphRoutesSTM();\n    }\n\n    if (selectSTM === 1 && plannedRoutesSTM !== prevState.plannedRoutesSTM) {\n      this.regenGraphRoutesSTM();\n    }\n\n    console.log(this.state)\n\n  }\n\n\n  componentWillUnmount = async () => {\n    leave();\n  }\n\n\n  handleClickSTM = async (e) => {\n    this.setState({\n      selectSTM: 1,\n      selectSTL: 0,\n      selectRTL: 0,\n      selectStops: [],\n      routeList: [],\n      plannedRoutesWithGraphs: []\n    })\n  }\n\n  handleClickRTL = async (e) => {\n    this.setState({\n      selectSTM: 0,\n      selectSTL: 0,\n      selectRTL: 1,\n      selectStops: [],\n      routeList: [],\n      plannedRoutesWithGraphs: []\n    })\n  }\n\n  stopRequestRTL = async (trip) => {\n    const stopsResponseRTL = await getStopsRTL(trip);\n    const parseStopsRTL = stopsResponseRTL.rows[0].jsonb_build_object\n    return parseStopsRTL\n  }\n\n  stopRequestSTM = async (trip) => {\n    const stopsResponseSTM = await getStopsSTM(trip);\n    const parseStopsSTM = stopsResponseSTM.rows[0].jsonb_build_object\n    return parseStopsSTM\n  }\n\n\n  regenGraphRoutesRTL = async () => {\n\n    //TODO: autoremove that are not online and not in timewindow\n\n    let routeList = [...this.state.routeList];\n    let tripList = [...this.state.plannedTripsRTL];\n    let uniqueTrip = [];\n\n\n    // Trip utilise pour generer les arrets de la ligne-direction\n    routeList.forEach((e) => {\n      uniqueTrip.push(\n        tripList.filter((f) => {\n          return f.ligneDir === e\n        })[0].tripmin\n      )\n    })\n\n    let stops = [...this.state.selectStops];\n\n    // Get stops info --only if it has not been fetched yet\n    // async/await fetch can't be included in forEach\n    // has to be in for...of\n    for (const e of uniqueTrip) {\n      if (stops.filter((f) => { return f.tripID === e }).length === 0) {\n        let tripStops = await this.stopRequestRTL(e);\n        stops.push({\n          tripID: e,\n          tripStops: tripStops\n        });\n      }\n    }\n\n    // Recalcul des lignes qui sont online\n    let visibleChartRoutes = [...this.state.plannedRoutesRTL];\n    //let visibleChartRoutesUpdate = longestRoutesSTM(visibleChartRoutes);\n\n    let tracesRTL = this.state.tracesRTL;\n    let vehiclesRTL = this.state.vehiclesRTL;\n\n    visibleChartRoutes = regenGraphRoutesRTL(\n      routeList,\n      tripList,\n      visibleChartRoutes,\n      stops,\n      vehiclesRTL,\n      tracesRTL);\n\n    //Affecter une cle unique correspondant a la position dans l'array\n    let keyID = 0;\n    visibleChartRoutes.forEach((e) => {\n      e.keyid = keyID;\n      keyID++;\n    })\n\n    this.setState({\n      plannedRoutesWithGraphs: visibleChartRoutes,\n      selectStops: stops\n    })\n\n  }\n\n  regenGraphRoutesSTM = async () => {\n\n    //TODO: autoremove that are not online and not in timewindow\n\n    let routeList = [...this.state.routeList];\n    let tripList = [...this.state.plannedTripsSTM];\n    let uniqueTrip = [];\n\n\n    // Trip utilise pour generer les arrets de la ligne-direction\n    routeList.forEach((e) => {\n      uniqueTrip.push(\n        tripList.filter((f) => {\n          return f.ligneDir === e\n        })[0].tripmin\n      )\n    })\n\n    let stops = [...this.state.selectStops];\n\n    // Get stops info --only if it has not been fetched yet\n    // async/await fetch can't be included in forEach\n    // has to be in for...of\n    for (const e of uniqueTrip) {\n      if (stops.filter((f) => { return f.tripID === e }).length === 0) {\n        let tripStops = await this.stopRequestSTM(e);\n        stops.push({\n          tripID: e,\n          tripStops: tripStops\n        });\n      }\n    }\n\n\n    let visibleChartRoutes = [...this.state.plannedRoutesSTM];\n\n    let tracesSTM = this.state.tracesSTM;\n    let vehiclesSTM = this.state.vehiclesSTM;\n\n    visibleChartRoutes = regenGraphRoutesSTM(\n      routeList,\n      tripList,\n      visibleChartRoutes,\n      stops,\n      vehiclesSTM,\n      tracesSTM);\n\n    //Affecter une cle unique correspondant a la position dans l'array\n    let keyID = 0;\n    visibleChartRoutes.forEach((e) => {\n      e.keyid = keyID;\n      keyID++;\n    })\n\n    this.setState({\n      plannedRoutesWithGraphs: visibleChartRoutes,\n      selectStops: stops\n    })\n\n  }\n\n\n\n  addToRouteList = async (e) => {\n    let routeListAdd = [...this.state.routeList];\n    routeListAdd.push(e);\n    this.setState({ routeList: routeListAdd })\n  }\n\n\n  removeFromRouteList = async (e) => {\n    let routeListRemove = [...this.state.routeList];\n    let routePosition = routeListRemove.indexOf(e);\n    routeListRemove.splice(routePosition, 1)\n\n    let stopListRemove = [...this.state.selectStops];\n    stopListRemove.splice(routePosition, 1)\n\n    this.setState({\n      routeList: routeListRemove,\n      selectStops: stopListRemove\n    })\n  }\n\n\n  handleRouteClickRTL = async (e) => {\n\n    //if trip is online and graph not showing\n    //add trip to list\n\n    //if trip is online and graph showing\n    //remove trip from list\n\n    const showhide = this.state.plannedRoutesRTL.filter((f) => {\n      return f.ligneDir === e.target.innerHTML\n    })[0].online === 1 && this.state.routeList.filter((f) => {\n      return f === e.target.innerHTML\n    }).length === 0 ?\n      this.addToRouteList(e.target.innerHTML) :\n      this.state.routeList.filter((f) => {\n        return f === e.target.innerHTML\n      }).length > 0 ?\n        this.removeFromRouteList(e.target.innerHTML)\n        : ''\n\n  }\n\n\n  handleRouteClickSTM = async (e) => {\n\n    const showhide = this.state.plannedRoutesSTM.filter((f) => {\n      return f.ligneDir === e.target.innerHTML\n    })[0].online === 1 && this.state.routeList.filter((f) => {\n      return f === e.target.innerHTML\n    }).length === 0 ?\n      this.addToRouteList(e.target.innerHTML) :\n      this.state.routeList.filter((f) => {\n        return f === e.target.innerHTML\n      }).length > 0 ?\n        this.removeFromRouteList(e.target.innerHTML)\n        : ''\n\n  }\n\n\n\n  render() {\n\n    return (\n      this.state.plannedTripsSTM ?\n        <div className=\"container-fluid\">\n\n          <div className=\"row\">\n            <div className=\"col-sm\">\n              <h1 id=\"title-card\" className=\"display-4\">Vue linaire par ligne</h1>\n            </div>\n          </div>\n          <div className=\"row justify-content-center\">\n            <div className=\"col-sm-4 mt-2 mb-2\" style={{ textAlign: \"center\", backgroundColor: \"#E1FFE1\" }}>\n              Voyage planifi actif\n            </div>\n            <div className=\"col-sm-4 mt-2 mb-2\" style={{ textAlign: \"center\", backgroundColor: \"#FFE2E2\" }}>\n              Voyage planifi inactif\n            </div>\n          </div>\n\n          <div className=\"row no-gutters\">\n            <div className=\"col\">\n              <button\n                id=\"agency-card\"\n                type=\"button\" className=\"col btn btn-outline-info\"\n                style={this.state.selectSTM === 1 ?\n                  { backgroundColor: \"#38B2A3\", color: \"#FFFFFF\" } :\n                  { backgroundColor: \"#E9F1F3\", color: \"#000000\" }}\n                onClick={(e) => this.handleClickSTM(e)}>\n                STM\n            </button>\n            </div>\n            <div className=\"col\">\n              <button type=\"button\" className=\"col btn btn-outline-secondary\" disabled>\n                STL\n            </button>\n            </div>\n            <div className=\"col\">\n              <button\n                type=\"button\" className=\"col btn btn-outline-info\"\n                style={this.state.selectRTL === 1 ?\n                  { backgroundColor: \"#38B2A3\", color: \"#FFFFFF\" } :\n                  { backgroundColor: \"#E9F1F3\", color: \"#000000\" }}\n                onClick={(e) => this.handleClickRTL(e)}>\n                RTL\n            </button>\n            </div>\n          </div>\n\n\n          <div className=\"row\">\n            <div className=\"col\">\n              <table id=\"tableOnline\" className=\"table\">\n                <thead>\n                  <tr>\n                    <th style={{ width: \"10%\" }}>\n                      Ligne\n                  </th>\n                    <th style={{ width: \"20%\" }}>\n                      Direction\n                  </th>\n                    <th style={{ width: \"70%\" }}>\n                      Ligne-dir\n                  </th>\n                  </tr>\n                </thead>\n                <tbody>\n                  {this.state.selectRTL === 1 && this.state.plannedRoutesWithGraphs.length > 0 ? this.state.plannedRoutesWithGraphs.map((e) => e.graph === undefined ? (\n                    <tr\n                      key={e.keyid}\n                      style={{\n                        backgroundColor: e.online === 1 ? \"#E1FFE1\" : \"#FFE2E2\"\n                      }}>\n                      <td>{e.route_id}</td>\n                      <td>{e.direction_id === 1 ? '1' : '0'}</td>\n                      <td style={{\n                        cursor: e.online === 1 ? 'pointer' : 'default'\n                      }}\n                        onClick={(event) => this.handleRouteClickRTL(event)}>{e.ligneDir}</td>\n                    </tr>\n                  ) : <tr key={e.keyid}>\n                      <td\n                        colSpan=\"3\">\n                        {e.tripmin}\n                      </td>\n                    </tr>) : this.state.selectRTL === 1 && this.state.plannedRoutesWithGraphs.length === 0 ?\n                      <tr>\n                        <td colSpan=\"3\" style={{ textAlign: \"center\" }}>\n                          <ReactLoading type={\"bubbles\"} color={\"#277D98\"} height={200} width={100} />\n                        </td>\n                      </tr> :\n                      this.state.selectSTM === 1 && this.state.plannedRoutesWithGraphs.length > 0 ? this.state.plannedRoutesWithGraphs.map((e) => e.graph === undefined ? (\n                        <tr\n                          key={e.keyid}\n                          style={{\n                            backgroundColor: e.online === 1 ? \"#E1FFE1\" : \"#FFE2E2\"\n                          }}>\n                          <td>{e.route_id}</td>\n                          <td>{e.direction_id}</td>\n                          <td\n                            style={{\n                              cursor: e.online === 1 ? 'pointer' : 'default'\n                            }}\n                            onClick={(event) => this.handleRouteClickSTM(event)}>{e.ligneDir}</td>\n                        </tr>\n                      ) : <tr key={e.keyid}>\n                          <td\n                            colSpan=\"3\"\n                          >\n                            {e.tripmin}\n                          </td>\n                        </tr>) :\n                        this.state.selectSTM === 1 && this.state.plannedRoutesWithGraphs.length === 0 ?\n                          <tr>\n                            <td colSpan=\"3\" style={{ textAlign: \"center\" }}>\n                              <ReactLoading type={\"bubbles\"} color={\"#277D98\"} height={200} width={100} />\n                            </td>\n                          </tr> :\n                          <tr>\n                            <td colSpan=\"3\" style={{ textAlign: \"center\" }}> Slectionner une agence</td>\n                          </tr>}\n                </tbody>\n              </table>\n            </div>\n          </div>\n        </div >\n        : <div className=\"container\">\n          <div className=\"row justify-content-center\">Chargement en cours...</div>\n          <div className=\"row justify-content-center\">\n            <div><ReactLoading type={\"bars\"} color={\"#277D98\"} height={300} width={175} /></div>\n          </div>\n        </div>\n    )\n  }\n}\n\nexport default Liveroutes;","import React, { Component } from 'react';\nimport { getHistory } from '../API';\nimport {\n  ResponsiveContainer,\n  ScatterChart,\n  Scatter,\n  XAxis,\n  YAxis,\n  ZAxis,\n  Tooltip,\n  Legend\n} from 'recharts';\n\nimport ReactLoading from 'react-loading';\n\nconst moment = require('moment');\n\nclass Historique extends Component {\n\n  state = {\n    history: null\n  };\n\n  componentDidMount = async () => {\n\n    const allVehicles = await getHistory()\n\n    const parseAll = [];\n\n    // Convert hh:mm:ss to unix milliseconds\n    // Format required by recharts for time series\n    // Voir si c'est possible d'utiliser autre chose que moment pour la conversion (trop long)\n\n    const parsing = allVehicles ?\n      allVehicles.forEach((e) => {\n        parseAll.push({\n          time: parseInt(moment(\"2019-04-28 \" + e.timestr).format('x')),\n          vehlen: Number(e.sum),\n          weekday: e.weekday,\n          date: e.rid.substr(0, 4)+'-'+e.rid.substr(4,2)+'-'+e.rid.substr(6,2),\n          groupe: e.groupe,\n          rid: e.rid\n        })\n      }) : ''\n\n    // Split weekdays, saturdays, sundays\n\n    const week = parseAll.filter((e) => {\n      return parseInt(e.weekday) > 0 && parseInt(e.weekday) < 6\n    })\n\n    const saturday = parseAll.filter((e) => {\n      return parseInt(e.weekday) === 6\n    })\n\n    const sunday = parseAll.filter((e) => {\n      return parseInt(e.weekday) === 0\n    })\n\n\n    this.setState({\n      week: week,\n      saturday: saturday,\n      sunday: sunday\n    })\n\n  }\n\n\n\n  render() {\n\n    const CustomTooltip = ({ active, payload }) => {\n      if (active) {\n        return (\n          <div className=\"custom-tooltip\">\n            <p className=\"label\">Agence : {payload[0].payload.groupe}<br />\n              Date : {payload[0].payload.date} <br />\n              Heure : {moment(payload[0].payload.time).format('HH:mm:ss')}<br />\n              Vhicules actifs : {payload[0].payload.vehlen}</p>\n          </div>\n        );\n      }\n\n      return null;\n    };\n\n    return this.state.sunday ? (\n      <div className=\"container-fluid\">\n        <div className=\"row\">\n          <div className=\"col-sm\">\n            <h1 id=\"title-card\" className=\"display-4\">Vhicules actifs dans les 3 derniers jours</h1>\n          </div>\n        </div>\n\n        <div id=\"chart-card\">\n          <h4 style={{ color: '#000000', textAlign: 'center' }}>Semaine</h4>\n          <ResponsiveContainer width=\"100%\" height={350}>\n            <ScatterChart width={730} height={250}\n              margin={{ top: 5, right: 30, left: 20, bottom: 5 }}>\n              <XAxis\n                type=\"number\"\n                dataKey=\"time\"\n                name='time'\n                domain={[1556420760000, 1556495999000]}\n                tickFormatter={(unixTime) => moment(unixTime).format('HH:mm:ss')}\n                ticks={[\n                  1556424000100,\n                  1556427600000, 1556431200000, 1556434800000, 1556438400000,\n                  1556442000000, 1556445600000, 1556449200000, 1556452800000,\n                  1556456400000, 1556460000000, 1556463600000, 1556467200000,\n                  1556470800000, 1556474400000, 1556478000000, 1556481600000,\n                  1556485200000, 1556488800000, 1556492400000, 1556496000000,\n                  1556499600000, 1556503200000, 1556506800000, 1556510399900\n                ]}\n              />\n              <YAxis yAxisId=\"left\" dataKey=\"vehlen\" name='vhicules'\n                label={{ value: 'STM', angle: -90, position: 'insideLeft' }} />\n              <YAxis yAxisId=\"right\" orientation=\"right\" dataKey=\"vehlen\" name='vhicules'\n                label={{ value: 'STL, RTL, exo', angle: -90, position: 'right' }} />\n              <ZAxis dataKey=\"z\" range={[10]} />\n              <Tooltip\n                content={<CustomTooltip />}\n              />\n              <Legend />\n              <Scatter yAxisId=\"left\" name=\"STM\" data={this.state.week.filter((e) => { return e.groupe === 'STM' })} fill=\"#009DE0\" />\n              <Scatter yAxisId=\"right\" name=\"STL\" data={this.state.week.filter((e) => { return e.groupe === 'STL' })} fill=\"#82C341\" />\n              <Scatter yAxisId=\"right\" name=\"RTL\" data={this.state.week.filter((e) => { return e.groupe === 'RTL' })} fill=\"#A93332\" />\n              <Scatter yAxisId=\"right\" name=\"exo\" data={this.state.week.filter((e) => { return e.groupe === 'exo' })} fill=\"#000000\" />\n            </ScatterChart>\n          </ResponsiveContainer>\n        </div >\n\n\n        <div id=\"chart-card\">\n          <h4 style={{ color: '#000000', textAlign: 'center' }}>Samedi</h4>\n          <ResponsiveContainer width=\"100%\" height={350}>\n            <ScatterChart width={730} height={250}\n              margin={{ top: 5, right: 30, left: 20, bottom: 5 }}>\n              <XAxis\n                type=\"number\"\n                dataKey=\"time\"\n                name='time'\n                domain={[1556420760000, 1556495999000]}\n                tickFormatter={(unixTime) => moment(unixTime).format('HH:mm:ss')}\n                ticks={[\n                  1556424000100,\n                  1556427600000, 1556431200000, 1556434800000, 1556438400000,\n                  1556442000000, 1556445600000, 1556449200000, 1556452800000,\n                  1556456400000, 1556460000000, 1556463600000, 1556467200000,\n                  1556470800000, 1556474400000, 1556478000000, 1556481600000,\n                  1556485200000, 1556488800000, 1556492400000, 1556496000000,\n                  1556499600000, 1556503200000, 1556506800000, 1556510399900\n                ]} />\n              <YAxis yAxisId=\"left\" dataKey=\"vehlen\" name='vhicules'\n                label={{ value: 'STM', angle: -90, position: 'insideLeft' }} />\n              <YAxis yAxisId=\"right\" orientation=\"right\" dataKey=\"vehlen\" name='vhicules'\n                label={{ value: 'STL, RTL, exo', angle: -90, position: 'right' }} />\n              <ZAxis dataKey=\"z\" range={[10]} />\n              <Tooltip\n                content={<CustomTooltip />}\n              />\n              <Legend />\n              <Scatter yAxisId=\"left\" name=\"STM\" data={this.state.saturday.filter((e) => { return e.groupe === 'STM' })} fill=\"#009DE0\" />\n              <Scatter yAxisId=\"right\" name=\"STL\" data={this.state.saturday.filter((e) => { return e.groupe === 'STL' })} fill=\"#82C341\" />\n              <Scatter yAxisId=\"right\" name=\"RTL\" data={this.state.saturday.filter((e) => { return e.groupe === 'RTL' })} fill=\"#A93332\" />\n              <Scatter yAxisId=\"right\" name=\"exo\" data={this.state.saturday.filter((e) => { return e.groupe === 'exo' })} fill=\"#000000\" />\n            </ScatterChart>\n          </ResponsiveContainer>\n        </div >\n\n        <div id=\"chart-card\">\n          <h4 style={{ color: '#000000', textAlign: 'center' }}>Dimanche</h4>\n          <ResponsiveContainer width=\"100%\" height={350}>\n            <ScatterChart width={500} height={250}\n              margin={{ top: 5, right: 30, left: 20, bottom: 5 }}>\n              <XAxis\n                type=\"number\"\n                dataKey=\"time\"\n                name='time'\n                domain={[1556420760000, 1556495999000]}\n                tickFormatter={(unixTime) => moment(unixTime).format('HH:mm:ss')}\n                ticks={[\n                  1556424000100,\n                  1556427600000, 1556431200000, 1556434800000, 1556438400000,\n                  1556442000000, 1556445600000, 1556449200000, 1556452800000,\n                  1556456400000, 1556460000000, 1556463600000, 1556467200000,\n                  1556470800000, 1556474400000, 1556478000000, 1556481600000,\n                  1556485200000, 1556488800000, 1556492400000, 1556496000000,\n                  1556499600000, 1556503200000, 1556506800000, 1556510399900\n                ]} />\n              <YAxis yAxisId=\"left\" dataKey=\"vehlen\" name='vhicules'\n                label={{ value: 'STM', angle: -90, position: 'insideLeft' }} />\n              <YAxis yAxisId=\"right\" orientation=\"right\" dataKey=\"vehlen\" name='vhicules'\n                label={{ value: 'STL, RTL, exo', angle: -90, position: 'right' }} />\n              <ZAxis dataKey=\"z\" range={[10]} />\n              <Tooltip\n                content={<CustomTooltip />}\n              />\n              <Legend />\n              <Scatter yAxisId=\"left\" name=\"STM\" data={this.state.sunday.filter((e) => { return e.groupe === 'STM' })} fill=\"#009DE0\" />\n              <Scatter yAxisId=\"right\" name=\"STL\" data={this.state.sunday.filter((e) => { return e.groupe === 'STL' })} fill=\"#82C341\" />\n              <Scatter yAxisId=\"right\" name=\"RTL\" data={this.state.sunday.filter((e) => { return e.groupe === 'RTL' })} fill=\"#A93332\" />\n              <Scatter yAxisId=\"right\" name=\"exo\" data={this.state.sunday.filter((e) => { return e.groupe === 'exo' })} fill=\"#000000\" />\n            </ScatterChart>\n          </ResponsiveContainer>\n        </div >\n\n      </div>\n    ) : <div className=\"container\">\n        <div className=\"row justify-content-center\">Chargement en cours...</div>\n        <div className=\"row justify-content-center\">\n          <div><ReactLoading type={\"bars\"} color={\"#277D98\"} height={300} width={175} /></div>\n        </div>\n      </div >\n  }\n}\n\nexport default Historique;\n\n","import React, { Component } from 'react';\n\nimport ReactLoading from 'react-loading';\n\nimport {getStatsGtfs} from '../API';\n\nclass Statsgtfs extends Component {\n\n  state = {\n    \n  };\n\n\n  componentDidMount = async () => {\n\n    const allStats = await getStatsGtfs();\n\n    this.setState({\n      \n    })\n\n  }\n\n\n\n\n  render() {\n\n    return this.state.sunday ? (\n        <div className=\"container\">\n\n        </div>\n    ) : <div className=\"container\">\n        <div className=\"row justify-content-center\">Chargement en cours...</div>\n        <div className=\"row justify-content-center\">\n          <div><ReactLoading type={\"bars\"} color={\"#277D98\"} height={300} width={175} /></div>\n        </div>\n      </div >\n  }\n}\n\nexport default Statsgtfs;\n\n","import React from 'react';\nimport { Switch, Route } from 'react-router-dom';\n\nimport NotFound from './NotFound';\nimport HowTo from './HowTo';\n\nimport Livemap from '../containers/Livemap';\nimport Livetrips from '../containers/Livetrips';\nimport Liveroutes from '../containers/Liveroutes';\nimport Historique from '../containers/Historique';\nimport Statsgtfs from '../containers/Statsgtfs';\n\n\nconst Routes = () => (\n  <Switch>\n    <Route exact path=\"/\" component={Livemap} />\n    <Route exact path=\"/historique\" component={Historique} />\n    <Route exact path=\"/livetrips\" component={Livetrips} />\n    <Route exact path=\"/liveroutes\" component={Liveroutes} />\n    <Route exact path=\"/statsgtfs\" component={Statsgtfs} />\n    <Route exact path=\"/howto\" component={HowTo} />\n    <Route path=\"*\" component={NotFound} />\n  </Switch>\n);\n\nexport default Routes;\n","import React, { Component } from 'react';\nimport Header from './components/Header';\nimport Footer from './components/Footer';\nimport Routes from './components/Routes';\nimport './App.css';\n\nclass App extends Component {\n  render() {\n    return (\n      <React.Fragment>\n        <Header />\n        <main id=\"app\">\n          <Routes />\n        </main>\n        <Footer />\n      </React.Fragment>\n    );\n  }\n}\n\nexport default App;","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport { BrowserRouter as Router } from 'react-router-dom';\nimport App from './App';\n\nReactDOM.render(\n  <Router>\n    <App />\n  </Router>, document.getElementById('root'));\n"],"sourceRoot":""}