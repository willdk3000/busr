(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{215:function(e,t,a){e.exports=a(437)},253:function(e,t){},436:function(e,t,a){},437:function(e,t,a){"use strict";a.r(t);var n=a(1),r=a.n(n),i=a(76),s=a.n(i),c=a(35),o=a(7),l=a(6),u=a(12),p=a(11),d=a(13),m=function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{id:"headnav",className:"container-fluid"},r.a.createElement("nav",{className:"navbar navbar-expand-md"},r.a.createElement("p",{className:"navbar-brand mb-0 h1 text-white"},r.a.createElement("i",{className:"fas fa-rss"})," busr"),r.a.createElement("button",{className:"navbar-toggler",type:"button","data-toggle":"collapse","data-target":"#navbarNavAltMarkup","aria-controls":"navbarNavAltMarkup","aria-expanded":"false","aria-label":"Toggle navigation"},r.a.createElement("i",{className:"fas fa-bars",style:{color:"#FFFFFF"}})),r.a.createElement("div",{className:"collapse navbar-collapse",id:"navbarNavAltMarkup"},r.a.createElement("div",{className:"navbar-nav"},r.a.createElement(c.b,{className:"nav-item nav-link text-white",to:"/",style:{textDecoration:"none",color:"#FFFFFF"}},"Carte"),r.a.createElement(c.b,{className:"nav-item nav-link text-white",to:"/historique",style:{textDecoration:"none",color:"#FFFFFF"}},"Courbe de service"),r.a.createElement(c.b,{className:"nav-item nav-link text-white",to:"/statsgtfs",style:{textDecoration:"none",color:"#FFFFFF"}},"Stats GTFS"))))))},f=function(){return r.a.createElement("div",{className:"container-fluid"},r.a.createElement("nav",{className:"navbar sticky-bottom navbar-light bg-light"},r.a.createElement("span",{className:"navbar-brand"},r.a.createElement("a",{id:"footer-name",style:{textDecoration:"none"},href:"https://www.github.com/willdk3000/busr"},"\xa9 busr 2019"))))},h=a(36),v=function(){return r.a.createElement("div",{className:"container-fluid"},r.a.createElement("div",{className:"jumbotron"},r.a.createElement("div",{className:"container"},r.a.createElement("h1",{className:"display-4"},"Not found..."),r.a.createElement("p",{className:"lead"},"The page you are looking for is unavailable."))))},T=function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"container-fluid"},r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-sm"},r.a.createElement("h1",{id:"title-card",className:"display-4"},"Utilisation de busr"))),r.a.createElement("div",{className:"jumbotron"},r.a.createElement("div",{className:"container"},r.a.createElement("h1",{className:"display-4"},"busr = bus + realtime"),r.a.createElement("p",{className:"lead"},"busr est un tableau de bord qui utilise les donn\xe9es ouvertes disponibles pour visualiser en temps r\xe9el l'\xe9tat du service d'autobus de la STM, de la STL et du RTL")))))},E=a(17),y=a(3),b=a.n(y),g=a(10),S=a(190),L=function(e){function t(){return Object(o.a)(this,t),Object(u.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"container-fluid"},r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-sm",id:"stat-card"},r.a.createElement("div",{id:"nom-stat"},"Agence :"),r.a.createElement("div",{id:"stat"},"STM")),r.a.createElement("div",{className:"col-sm",id:"stat-card"},r.a.createElement("div",{id:"nom-stat"},"API :"),r.a.createElement("div",{id:"stat"},"gtfs-r")),r.a.createElement("div",{className:"col-sm",id:"stat-card"},r.a.createElement("div",{id:"nom-stat"},"Mise \xe0 jour :"),r.a.createElement("div",{id:"stat"},this.props.lastRefreshSTM.substr(0,8))),r.a.createElement("div",{className:"col-sm",id:"stat-card"},r.a.createElement("div",{id:"nom-stat"},"V\xe9hicules actifs / planifi\xe9s :"),r.a.createElement("div",{id:"stat"},this.props.onlineVehiclesSTM," / ",this.props.plannedVehiclesSTM)),r.a.createElement("div",{className:"col-sm",id:"stat-card"},r.a.createElement("div",{id:"nom-stat"},"Lignes en service :"),r.a.createElement("div",{id:"stat"},this.props.routesSTM))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-sm",id:"stat-card"},r.a.createElement("div",{id:"nom-stat"},"Agence :"),r.a.createElement("div",{id:"stat"},"STL")),r.a.createElement("div",{className:"col-sm",id:"stat-card"},r.a.createElement("div",{id:"nom-stat"},"API :"),r.a.createElement("div",{id:"stat"},"nextbus")),r.a.createElement("div",{className:"col-sm",id:"stat-card"},r.a.createElement("div",{id:"nom-stat"},"Mise \xe0 jour :"),r.a.createElement("div",{id:"stat"},this.props.lastRefreshSTL.substr(0,8))),r.a.createElement("div",{className:"col-sm",id:"stat-card"},r.a.createElement("div",{id:"nom-stat"},"V\xe9hicules actifs / planifi\xe9s :"),r.a.createElement("div",{id:"stat"},this.props.onlineVehiclesSTL," / ",this.props.plannedVehiclesSTL)),r.a.createElement("div",{className:"col-sm",id:"stat-card"},r.a.createElement("div",{id:"nom-stat"},"Lignes en service :"),r.a.createElement("div",{id:"stat"},this.props.routesSTL))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-sm",id:"stat-card"},r.a.createElement("div",{id:"nom-stat"},"Agence :"),r.a.createElement("div",{id:"stat"},"RTL")),r.a.createElement("div",{className:"col-sm",id:"stat-card"},r.a.createElement("div",{id:"nom-stat"},"API :"),r.a.createElement("div",{id:"stat"},"gtfs-r")),r.a.createElement("div",{className:"col-sm",id:"stat-card"},r.a.createElement("div",{id:"nom-stat"},"Mise \xe0 jour :"),r.a.createElement("div",{id:"stat"},this.props.lastRefreshRTL.substr(0,8))),r.a.createElement("div",{className:"col-sm",id:"stat-card"},r.a.createElement("div",{id:"nom-stat"},"V\xe9hicules actifs / planifi\xe9s :"),r.a.createElement("div",{id:"stat"},this.props.onlineVehiclesRTL," / ",this.props.plannedVehiclesRTL)),r.a.createElement("div",{className:"col-sm",id:"stat-card"},r.a.createElement("div",{id:"nom-stat"},"Lignes en service :"),r.a.createElement("div",{id:"stat"},this.props.routesRTL))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-sm",id:"stat-card"},r.a.createElement("div",{id:"nom-stat"},"Agence :"),r.a.createElement("div",{id:"stat"},"exo"),r.a.createElement("div",{id:"nom-stat"},"Trac\xe9s \xe0 venir")),r.a.createElement("div",{className:"col-sm align-middle",id:"stat-card"},r.a.createElement("div",{id:"nom-stat"},"API :"),r.a.createElement("div",{id:"stat"},"gtfs-r")),r.a.createElement("div",{className:"col-sm",id:"stat-card"},r.a.createElement("div",{id:"nom-stat"},"Mise \xe0 jour :"),r.a.createElement("div",{id:"stat"},this.props.lastRefreshEXO.substr(0,8))),r.a.createElement("div",{className:"col-sm",id:"stat-card"},r.a.createElement("div",{id:"nom-stat"},"V\xe9hicules actifs / planifi\xe9s :"),r.a.createElement("div",{id:"stat"},this.props.onlineVehiclesEXO," / ",this.props.plannedVehiclesEXO)),r.a.createElement("div",{className:"col-sm",id:"stat-card"},r.a.createElement("div",{id:"nom-stat"},"Lignes en service :"),r.a.createElement("div",{id:"stat"},this.props.routesEXO)))))}}]),t}(n.Component),x=a(180),w=a.n(x).a.connect("wss://busr.ngrok.io",{transports:["websocket"]});function k(e){return R.apply(this,arguments)}function R(){return(R=Object(g.a)(b.a.mark(function e(t){return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:w.on("refresh data",function(e){return t(null,e)}),w.emit("subscribeToTimer",3e3);case 2:case"end":return e.stop()}},e)}))).apply(this,arguments)}function j(){return M.apply(this,arguments)}function M(){return(M=Object(g.a)(b.a.mark(function e(){return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:w.emit("leave");case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}function O(){return F.apply(this,arguments)}function F(){return(F=Object(g.a)(b.a.mark(function e(){var t;return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/api/traces_stm");case 2:return t=e.sent,e.abrupt("return",t.json());case 4:case"end":return e.stop()}},e)}))).apply(this,arguments)}function N(e){return _.apply(this,arguments)}function _(){return(_=Object(g.a)(b.a.mark(function e(t){var a;return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/api/stops_stm",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({trip:t})});case 2:return a=e.sent,e.abrupt("return",a.json());case 4:case"end":return e.stop()}},e)}))).apply(this,arguments)}function D(){return C.apply(this,arguments)}function C(){return(C=Object(g.a)(b.a.mark(function e(){var t;return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/api/traces_stl");case 2:return t=e.sent,e.abrupt("return",t.json());case 4:case"end":return e.stop()}},e)}))).apply(this,arguments)}function A(e){return I.apply(this,arguments)}function I(){return(I=Object(g.a)(b.a.mark(function e(t){var a;return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/api/stops_stl",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({trace:t})});case 2:return a=e.sent,e.abrupt("return",a.json());case 4:case"end":return e.stop()}},e)}))).apply(this,arguments)}function G(){return H.apply(this,arguments)}function H(){return(H=Object(g.a)(b.a.mark(function e(){var t;return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/api/traces_rtl");case 2:return t=e.sent,e.abrupt("return",t.json());case 4:case"end":return e.stop()}},e)}))).apply(this,arguments)}function V(e){return X.apply(this,arguments)}function X(){return(X=Object(g.a)(b.a.mark(function e(t){var a;return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/api/stops_rtl",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({trip:t})});case 2:return a=e.sent,e.abrupt("return",a.json());case 4:case"end":return e.stop()}},e)}))).apply(this,arguments)}function W(){return K.apply(this,arguments)}function K(){return(K=Object(g.a)(b.a.mark(function e(){var t;return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/api/allvehicles");case 2:return t=e.sent,e.abrupt("return",t.json());case 4:case"end":return e.stop()}},e)}))).apply(this,arguments)}function B(){return z.apply(this,arguments)}function z(){return(z=Object(g.a)(b.a.mark(function e(){var t;return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/api/statsgtfs");case 2:return t=e.sent,e.abrupt("return",t.json());case 4:case"end":return e.stop()}},e)}))).apply(this,arguments)}a(55);var q=function(e){function t(){var e,a;Object(o.a)(this,t);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(a=Object(u.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(r)))).state={viewport:{latitude:45.556827,longitude:-73.662362,zoom:9}},a.componentDidMount=Object(g.a)(b.a.mark(function e(){var t,n,r,i;return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return k(function(e,t){var n=t?t[0].filter(function(e){return"STM"===e.reseau}):"",r=t?t[0].filter(function(e){return"STL"===e.reseau}):"",i=t?t[0].filter(function(e){return"RTL"===e.reseau}):"",s=t?t[0].filter(function(e){return"exo"===e.groupe}):"",c={type:"FeatureCollection",features:[]};s.forEach(function(e){e.data.features.forEach(function(e,t){c.features.push(e)})}),a.setState({vehiclesSTM:n[0].data,vehiclesSTL:r[0].data,vehiclesRTL:i[0].data,vehiclesEXO:c,timestampSTM:n[0].timestr,timestampSTL:r[0].timestr,timestampRTL:i[0].timestr,timestampEXO:s[0].timestr,plannedTripsRTL:t?t[1]:"",plannedTripsSTL:t?t[2]:"",plannedTripsSTM:t?t[3]:""})}),t=a.reactMap.getMap(),a.handleOnLoad(t),e.next=5,O();case 5:return n=e.sent,a.setState({tracesSTM:n.rows[0].jsonb_build_object}),e.next=9,D();case 9:return r=e.sent,a.setState({tracesSTL:r.rows[0].jsonb_build_object}),e.next=13,G();case 13:i=e.sent,a.setState({tracesRTL:i.rows[0].jsonb_build_object});case 15:case"end":return e.stop()}},e)})),a.componentWillUnmount=Object(g.a)(b.a.mark(function e(){return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:a.map.remove(),j();case 2:case"end":return e.stop()}},e)})),a.handleOnLoad=function(){var e=Object(g.a)(b.a.mark(function e(t){var n;return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n={type:"FeatureCollection",features:[]},t.on("load",function(){t.addSource("vehiculesSTM",{type:"geojson",data:n}),t.addSource("vehiculesSTL",{type:"geojson",data:n}),t.addSource("vehiculesRTL",{type:"geojson",data:n}),t.addSource("vehiculesEXO",{type:"geojson",data:n}),t.addSource("tracesSTM",{type:"geojson",data:n}),t.addSource("tracesSTL",{type:"geojson",data:n}),t.addSource("tracesRTL",{type:"geojson",data:n}),t.addSource("stopsSTM",{type:"geojson",data:n}),t.addSource("stopsRTL",{type:"geojson",data:n}),t.addSource("stopsSTL",{type:"geojson",data:n}),t.addLayer({id:"position-vehicules-stm",type:"symbol",source:"vehiculesSTM",layout:{"text-field":String.fromCharCode("0xF207"),"text-font":["Font Awesome 5 Free Solid"],"text-size":12},paint:{"text-color":"#009DE0"}}),t.addLayer({id:"position-vehicules-stl",type:"symbol",source:"vehiculesSTL",layout:{"text-field":String.fromCharCode("0xF207"),"text-font":["Font Awesome 5 Free Solid"],"text-size":12},paint:{"text-color":"#82C341"}}),t.addLayer({id:"position-vehicules-rtl",type:"symbol",source:"vehiculesRTL",layout:{"text-field":String.fromCharCode("0xF207"),"text-font":["Font Awesome 5 Free Solid"],"text-size":12},paint:{"text-color":"#A93332"}}),t.addLayer({id:"position-vehicules-exo",type:"symbol",source:"vehiculesEXO",layout:{"text-field":String.fromCharCode("0xF207"),"text-font":["Font Awesome 5 Free Solid"],"text-size":12},paint:{"text-color":"#000000"}}),t.addLayer({id:"tracesSTM",type:"line",source:"tracesSTM",layout:{"line-join":"round","line-cap":"round",visibility:"visible"},paint:{"line-width":2,"line-color":"#2380A5"}}),t.addLayer({id:"tracesSTL",type:"line",source:"tracesSTL",layout:{"line-join":"round","line-cap":"round",visibility:"visible"},paint:{"line-width":2,"line-color":"#4A913C"}}),t.addLayer({id:"tracesRTL",type:"line",source:"tracesRTL",layout:{"line-join":"round","line-cap":"round",visibility:"visible"},paint:{"line-width":2,"line-color":"#C47B85"}}),t.addLayer({id:"stopsSTM",type:"circle",source:"stopsSTM",paint:{"circle-radius":3,"circle-color":"#009DE0"}}),t.addLayer({id:"stopsRTL",type:"circle",source:"stopsRTL",paint:{"circle-radius":3,"circle-color":"#A93332"}}),t.addLayer({id:"stopsSTL",type:"circle",source:"stopsSTL",paint:{"circle-radius":3,"circle-color":"#82C341"}}),a.setState({mapIsLoaded:!0})}),a.map=t;case 3:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.componentDidUpdate=function(){var e=Object(g.a)(b.a.mark(function e(t,n){var r,i,s,c,o,l,u,p,d,m,f,h,v;return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=a.state,i=r.vehiclesSTM,s=r.vehiclesSTL,c=r.vehiclesRTL,o=r.vehiclesEXO,a.state.mapIsLoaded){e.next=4;break}return e.abrupt("return");case 4:i!==n.vehiclesSTM&&(a.map.getSource("vehiculesSTM").setData(i),l=a.state.vehiclesSTM?a.state.vehiclesSTM.features.map(function(e){return e.properties.route_id}):"",u=Object(E.a)(new Set(l)),a.setState({routesSTM:u})),s!==n.vehiclesSTL&&(a.map.getSource("vehiculesSTL").setData(s),p=a.state.vehiclesSTL?a.state.vehiclesSTL.features.map(function(e){return e.properties.route_id}):"",d=Object(E.a)(new Set(p)),a.setState({routesSTL:d})),c!==n.vehiclesRTL&&(a.map.getSource("vehiculesRTL").setData(c),m=a.state.vehiclesRTL?a.state.vehiclesRTL.features.map(function(e){return e.properties.route_id}):"",f=Object(E.a)(new Set(m)),a.setState({routesRTL:f})),o!==n.vehiclesEXO&&(a.map.getSource("vehiculesEXO").setData(o),h=a.state.vehiclesEXO?a.state.vehiclesEXO.features.map(function(e){return e.properties.route_id}):"",v=Object(E.a)(new Set(h)),a.setState({routesEXO:v}));case 8:case"end":return e.stop()}},e)}));return function(t,a){return e.apply(this,arguments)}}(),a._onViewportChange=function(e){return a.setState({viewport:e})},a._onHover=function(e){var t=e.features,n=e.srcEvent,r=n.offsetX,i=n.offsetY,s=t&&t.find(function(e){return"position-vehicules-stm"===e.layer.id}),c=t&&t.find(function(e){return"stopsSTM"===e.layer.id}),o=t&&t.find(function(e){return"position-vehicules-stl"===e.layer.id}),l=t&&t.find(function(e){return"position-vehicules-rtl"===e.layer.id}),u=t&&t.find(function(e){return"position-vehicules-exo"===e.layer.id});a.setState({hoveredFeatureSTM:s,hoveredStopSTM:c,hoveredFeatureSTL:o,hoveredFeatureRTL:l,hoveredFeatureEXO:u,x:r,y:i})},a.stopRequestSTM=function(){var e=Object(g.a)(b.a.mark(function e(t){var a,n;return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,N(t);case 2:return a=e.sent,n=a.rows[0].jsonb_build_object,e.abrupt("return",n);case 5:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.stopRequestRTL=function(){var e=Object(g.a)(b.a.mark(function e(t){var a,n;return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,V(t);case 2:return a=e.sent,n=a.rows[0].jsonb_build_object,e.abrupt("return",n);case 5:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.stopRequestSTL=function(){var e=Object(g.a)(b.a.mark(function e(t){var a,n;return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,A(t);case 2:return a=e.sent,n=a.rows[0].jsonb_build_object,e.abrupt("return",n);case 5:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a._onClick=function(){var e=Object(g.a)(b.a.mark(function e(t){var n,r,i,s,c,o,l,u,p,d,m,f,h,v,T,E,y,g;return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=a.state.mapIsLoaded,r={type:"FeatureCollection",features:[]},i=t.features,s=t.srcEvent,c=s.offsetX,o=s.offsetY,l=i&&i.find(function(e){return"position-vehicules-stm"===e.layer.id}),u=i&&i.find(function(e){return"position-vehicules-stl"===e.layer.id}),p=i&&i.find(function(e){return"position-vehicules-rtl"===e.layer.id}),console.log(l),d=l?l.properties.trip_id:"",m=u?u.properties.route_id:"",f=p?p.properties.trip_id:"",console.log(d),h=a.state.tracesSTM?a.state.tracesSTM.features.filter(function(e){return e.properties.trips.some(function(e){return e===d})}):"",console.log(h),v=a.state.tracesSTL?a.state.tracesSTL.features.filter(function(e){return e.properties.route_short_name===m}):"",T=a.state.tracesRTL?a.state.tracesRTL.features.filter(function(e){return e.properties.trips.some(function(e){return e===f})}):"",!0===n?""!==d?a.map.getSource("tracesSTM").setData(h[0]):a.map.getSource("tracesSTM").setData(r):"",!0===n?""!==m?a.map.getSource("tracesSTL").setData(v[0]):a.map.getSource("tracesSTL").setData(r):"",!0===n?""!==f?a.map.getSource("tracesRTL").setData(T[0]):a.map.getSource("tracesRTL").setData(r):"",""===d){e.next=24;break}return e.next=21,a.stopRequestSTM(d);case 21:e.t0=e.sent,e.next=25;break;case 24:e.t0="";case 25:if(E=e.t0,a.setState({stopsSTM:E}),!0===n?""!==a.state.stopsSTM?a.map.getSource("stopsSTM").setData(a.state.stopsSTM):a.map.getSource("stopsSTM").setData(r):"",""===f){e.next=34;break}return e.next=31,a.stopRequestRTL(f);case 31:e.t1=e.sent,e.next=35;break;case 34:e.t1="";case 35:if(y=e.t1,a.setState({stopsRTL:y}),!0===n?""!==a.state.stopsRTL?a.map.getSource("stopsRTL").setData(a.state.stopsRTL):a.map.getSource("stopsRTL").setData(r):"",""===m){e.next=44;break}return e.next=41,a.stopRequestSTL(v[0].properties.ID);case 41:e.t2=e.sent,e.next=45;break;case 44:e.t2="";case 45:g=e.t2,a.setState({stopsSTL:g}),!0===n?""!==a.state.stopsSTL?a.map.getSource("stopsSTL").setData(a.state.stopsSTL):a.map.getSource("stopsSTL").setData(r):"",a.setState({clickedFeatureSTM:l,clickedFeatureSTL:u,clickedFeatureRTL:p,x:c,y:o});case 49:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a}return Object(d.a)(t,e),Object(l.a)(t,[{key:"_renderTooltip",value:function(){var e=this.state,t=e.hoveredFeatureSTM,a=(e.hoveredStopSTM,e.hoveredFeatureSTL),n=e.hoveredFeatureRTL,i=e.hoveredFeatureEXO,s=e.x,c=e.y,o=(e.mapIsLoaded,t?t.properties.trip_id:""),l=a?a.properties.route_id:"",u=n?n.properties.trip_id:"",p=i?i.properties.trip_id:"";this.state.tracesSTM&&this.state.tracesSTM.features.filter(function(e){return e.properties.trips.some(function(e){return e===o})}),this.state.tracesSTL&&this.state.tracesSTL.features.filter(function(e){return e.properties===l}),this.state.tracesRTL&&this.state.tracesRTL.features.filter(function(e){return e.properties.trips.some(function(e){return e===u})}),this.state.tracesEXO&&this.state.tracesEXO.features.filter(function(e){return e.properties.trips.some(function(e){return e===p})});return t?t&&r.a.createElement("div",{className:"mapToolTip",style:{left:s,top:c}},r.a.createElement("div",null,"R\xe9seau: ",t.properties.reseau),r.a.createElement("div",null,"V\xe9hicule: ",t.properties.vehicle_id),r.a.createElement("div",null,"Ligne: ",t.properties.route_id),r.a.createElement("div",null,"Trip ID: ",t.properties.trip_id),r.a.createElement("div",null,"Mise \xe0 jour: ",t.properties.timestamp?t.properties.timestamp:""," s")):a?a&&r.a.createElement("div",{className:"mapToolTip",style:{left:s,top:c}},r.a.createElement("div",null,"R\xe9seau: ",a.properties.reseau),r.a.createElement("div",null,"V\xe9hicule: ",a.properties.vehicle_id),r.a.createElement("div",null,"Ligne: ",a.properties.route_id),r.a.createElement("div",null,"Mise \xe0 jour: ",a.properties.last_connection," s")):n?n&&r.a.createElement("div",{className:"mapToolTip",style:{left:s,top:c}},r.a.createElement("div",null,"R\xe9seau: ",n.properties.reseau),r.a.createElement("div",null,"V\xe9hicule: ",n.properties.vehicle_id),r.a.createElement("div",null,"Ligne: ",n.properties.route_id),r.a.createElement("div",null,"Trip ID: ",n.properties.trip_id),r.a.createElement("div",null,"Mise \xe0 jour: ",n.properties.timestamp?n.properties.timestamp:""," s")):i?i&&r.a.createElement("div",{className:"mapToolTip",style:{left:s,top:c}},r.a.createElement("div",null,"R\xe9seau: ",i.properties.cit),r.a.createElement("div",null,"V\xe9hicule: ",i.properties.vehicle_id),r.a.createElement("div",null,"Ligne: ",i.properties.route_id),r.a.createElement("div",null,"Trip ID: ",i.properties.trip_id),r.a.createElement("div",null,"Mise \xe0 jour: ",i.properties.timestamp?i.properties.timestamp:""," s")):""}},{key:"render",value:function(){var e=this,t=this.state.viewport;return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"container-fluid"},r.a.createElement(L,{lastRefreshSTM:this.state.timestampSTM?this.state.timestampSTM:"-",onlineVehiclesSTM:this.state.vehiclesSTM?this.state.vehiclesSTM.features.length:0,plannedVehiclesSTM:this.state.plannedTripsSTM?this.state.plannedTripsSTM.length:0,routesSTM:this.state.routesSTM?this.state.routesSTM.length:0,lastRefreshSTL:this.state.timestampSTL?this.state.timestampSTL:"-",onlineVehiclesSTL:this.state.vehiclesSTL?this.state.vehiclesSTL.features.length:0,plannedVehiclesSTL:this.state.plannedTripsSTL?this.state.plannedTripsSTL.length:0,routesSTL:this.state.routesSTL?this.state.routesSTL.length:0,lastRefreshRTL:this.state.timestampRTL?this.state.timestampRTL:"-",onlineVehiclesRTL:this.state.vehiclesRTL?this.state.vehiclesRTL.features.length:0,plannedVehiclesRTL:this.state.plannedTripsRTL?this.state.plannedTripsRTL.length:0,routesRTL:this.state.routesRTL?this.state.routesRTL.length:0,lastRefreshEXO:this.state.timestampEXO?this.state.timestampEXO:"-",onlineVehiclesEXO:this.state.vehiclesEXO?this.state.vehiclesEXO.features.length:0,plannedVehiclesEXO:this.state.plannedTripsEXO?this.state.plannedTripsEXO:0,routesEXO:this.state.routesEXO?this.state.routesEXO.length:0}),r.a.createElement(S.a,Object.assign({},t,{ref:function(t){return e.reactMap=t},width:"100%",height:"85vh",mapStyle:"mapbox://styles/wdoucetk/cjun8whio1ha21fmzxt8knp7k",onViewportChange:this._onViewportChange,mapboxApiAccessToken:"pk.eyJ1Ijoid2RvdWNldGsiLCJhIjoiY2pnZnBhMjV1MHdwZjJwcWsyNGRjOGtzcCJ9.NNV1CVCSvwPa5Wb5D1Tv-Q",onHover:this._onHover,onClick:this._onClick}),this._renderTooltip())))}}]),t}(n.Component),P=a(22),J=a.n(P),U=a(5),Y=a(55);function Z(e,t,a,n,r){return Q.apply(this,arguments)}function Q(){return(Q=Object(g.a)(b.a.mark(function e(t,a,n,i,s){var c,o;return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return c=0,t.forEach(function(e){var t=[];a.map(function(e){t.push(e.tripmin)});var o=t.indexOf(e),l=n[c].tripStops;c++;var u=[];l.features.map(function(e){u.push({name:e.properties.name,time:e.properties.departure_time,x:e.properties.stop_sequence,y:0,z:15})});var p=i.features.filter(function(t){return t.properties.trip_id===e})[0].geometry.coordinates,d=s.features.filter(function(t){return t.properties.trips.some(function(t){return t===e})}),m=[];d[0].geometry.coordinates.map(function(e){m.push(e)});var f=Y.lineString(m),h=Y.point(p),v=Y.nearestPointOnLine(f,h,{units:"kilometers"}),T=[{x:Math.round(1e3*v.properties.location),y:0,z:60}];a.splice(o+1,0,{keyid:o+1,graph:1,online:a[o].online,timemin:parseInt(a[o].timemin),timemax:a[o].timemax,tripmin:r.a.createElement(U.b,{width:"98%",height:50},r.a.createElement(U.d,null,r.a.createElement(U.f,{type:"number",dataKey:"x",hide:!0}),r.a.createElement(U.g,{type:"number",dataKey:"y",hide:!0}),r.a.createElement(U.h,{type:"number",dataKey:"z",range:[10,100],domain:[15,75]}),r.a.createElement(U.e,{content:r.a.createElement(function(e){var t=e.active,a=e.payload;return t?r.a.createElement("div",{className:"custom-tooltip"},r.a.createElement("p",{className:"label"},a[0].payload.name,r.a.createElement("br",null),"Distance : ",a[0].payload.x,r.a.createElement("br",null),"Planifi\xe9 : ",a[0].payload.time)):null},null)}),r.a.createElement(U.c,{name:"Arrets",data:u,fill:"#000000",stroke:"#5B5B5B",line:!0,shape:"circle"}),r.a.createElement(U.c,{name:"Bus",data:T,fill:"#A93332",shape:"circle"})))})}),o=0,a.forEach(function(e){e.keyid=o,o++}),e.abrupt("return",a);case 5:case"end":return e.stop()}},e)}))).apply(this,arguments)}var $=a(55);function ee(e,t,a,n,r){return te.apply(this,arguments)}function te(){return(te=Object(g.a)(b.a.mark(function e(t,a,n,i,s){var c,o;return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return c=0,t.forEach(function(e){var t=[];a.map(function(e){t.push(e.tripmin)});var o=t.indexOf(e),l=n[c].tripStops;c++;var u=s.features.filter(function(t){return t.properties.trips.some(function(t){return t===e})}),p=[];u[0].geometry.coordinates.map(function(e){p.push(e)});var d=$.lineString(p),m=[];l.features.forEach(function(e){var t=$.point(e.geometry.coordinates),a=$.nearestPointOnLine(d,t,{units:"kilometers"}),n=Math.round(1e3*a.properties.location);m.push(n)});var f=[],h=0;l.features.map(function(e){f.push({name:e.properties.name,time:e.properties.departure_time,x:m[h],y:0,z:15}),h++});var v=i.features.filter(function(t){return t.properties.trip_id===e})[0].geometry.coordinates,T=$.point(v),E=$.nearestPointOnLine(d,T,{units:"kilometers"}),y=[{x:Math.round(1e3*E.properties.location),y:0,z:60}];a.splice(o+1,0,{keyid:o+1,graph:1,online:a[o].online,timemin:parseInt(a[o].timemin),timemax:a[o].timemax,tripmin:r.a.createElement(U.b,{width:"95%",height:50},r.a.createElement(U.d,null,r.a.createElement(U.f,{type:"number",dataKey:"x",hide:!0}),r.a.createElement(U.g,{type:"number",dataKey:"y",hide:!0}),r.a.createElement(U.h,{type:"number",dataKey:"z",range:[10,100],domain:[15,75]}),r.a.createElement(U.e,{content:r.a.createElement(function(e){var t=e.active,a=e.payload;return t?r.a.createElement("div",{className:"custom-tooltip"},r.a.createElement("p",{className:"label"},a[0].payload.name,r.a.createElement("br",null),"Distance : ",a[0].payload.x,r.a.createElement("br",null),"Planifi\xe9 : ",a[0].payload.time)):null},null)}),r.a.createElement(U.c,{name:"Arrets",data:f,fill:"#000000",stroke:"#5B5B5B",line:!0,shape:"circle"}),r.a.createElement(U.c,{name:"Bus",data:y,fill:"#009DE0",line:!0,shape:"circle"})))})}),o=0,a.forEach(function(e){e.keyid=o,o++}),e.abrupt("return",a);case 5:case"end":return e.stop()}},e)}))).apply(this,arguments)}var ae=a(176),ne=function(e){function t(){var e,a;Object(o.a)(this,t);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(a=Object(u.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(r)))).state={tripList:[],selectStops:[],selectSTM:0,selectSTL:0,selectRTL:0},a.componentDidMount=Object(g.a)(b.a.mark(function e(){var t,n;return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return k(function(e,t){var n=t?t[0].filter(function(e){return"STM"===e.reseau}):"",r=t?t[0].filter(function(e){return"STL"===e.reseau}):"",i=t?t[0].filter(function(e){return"RTL"===e.reseau}):"",s=0,c=(t[1].forEach(function(e){e.keyid=s,s++,i[0].data.features.filter(function(t){return t.properties.trip_id===e.tripmin}).length>0?e.online=1:e.online=0}),0);t[3].forEach(function(e){e.keyid=c,c++,n[0].data.features.filter(function(t){return t.properties.trip_id===e.tripmin}).length>0?e.online=1:e.online=0});a.setState({vehiclesSTM:t?n[0].data:"",vehiclesSTL:t?r[0].data:"",vehiclesRTL:t?i[0].data:"",timestampSTM:t?n[0].time:"",timestampSTL:t?r[0].time:"",timestampRTL:t?r[0].time:"",plannedTripsRTL:t?t[1]:"",plannedTripsSTL:t?t[2].sort(function(e,t){return e.timemin>t.timemin?1:-1}):"",plannedTripsSTM:t?t[3]:""})}),e.next=3,G();case 3:return t=e.sent,a.setState({tracesRTL:t.rows[0].jsonb_build_object}),e.next=7,O();case 7:n=e.sent,a.setState({tracesSTM:n.rows[0].jsonb_build_object}),1===a.state.selectRTL&&a.state.plannedTripsRTL&&a.regenGraphRTL(),1===a.state.selectSTM&&a.state.plannedTripsSTM&&a.regenGraphSTM();case 11:case"end":return e.stop()}},e)})),a.componentWillUnmount=Object(g.a)(b.a.mark(function e(){return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:j();case 1:case"end":return e.stop()}},e)})),a.handleClickSTM=function(){var e=Object(g.a)(b.a.mark(function e(t){return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:a.setState({selectSTM:1,selectSTL:0,selectRTL:0,tripList:[],selectStops:[],plannedTripsWithGraphs:[]});case 1:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.handleClickRTL=function(){var e=Object(g.a)(b.a.mark(function e(t){return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:a.setState({selectSTM:0,selectSTL:0,selectRTL:1,tripList:[],selectStops:[],plannedTripsWithGraphs:[]});case 1:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.stopRequestRTL=function(){var e=Object(g.a)(b.a.mark(function e(t){var a,n;return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,V(t);case 2:return a=e.sent,n=a.rows[0].jsonb_build_object,e.abrupt("return",n);case 5:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.stopRequestSTM=function(){var e=Object(g.a)(b.a.mark(function e(t){var a,n;return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,N(t);case 2:return a=e.sent,n=a.rows[0].jsonb_build_object,e.abrupt("return",n);case 5:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.regenGraphRTL=Object(g.a)(b.a.mark(function e(){var t,n,r,i,s,c,o,l,u,p,d,m,f;return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=Object(E.a)(a.state.tripList),n=Object(E.a)(a.state.selectStops),r=!0,i=!1,s=void 0,e.prev=5,c=b.a.mark(function e(){var t,r;return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=l.value,0!==n.filter(function(e){return e.tripID===t}).length){e.next=6;break}return e.next=4,a.stopRequestRTL(t);case 4:r=e.sent,n.push({tripID:t,tripStops:r});case 6:case"end":return e.stop()}},e)}),o=t[Symbol.iterator]();case 8:if(r=(l=o.next()).done){e.next=13;break}return e.delegateYield(c(),"t0",10);case 10:r=!0,e.next=8;break;case 13:e.next=19;break;case 15:e.prev=15,e.t1=e.catch(5),i=!0,s=e.t1;case 19:e.prev=19,e.prev=20,r||null==o.return||o.return();case 22:if(e.prev=22,!i){e.next=25;break}throw s;case 25:return e.finish(22);case 26:return e.finish(19);case 27:return u=Object(E.a)(a.state.plannedTripsRTL),p=[],a.state.tripList.length>0?a.state.tripList.forEach(function(e){a.state.plannedTripsRTL.filter(function(t){return e===t.tripmin}).length>0&&p.push(e)}):"",d=[],p.length>0?p.forEach(function(e){a.state.vehiclesRTL.features.filter(function(t){return t.properties.trip_id===e}).length>0&&d.push(e)}):"",m=a.state.vehiclesRTL,f=a.state.tracesRTL,e.next=36,Z(d,u,n,m,f);case 36:u=e.sent,a.setState({plannedTripsWithGraphs:u,tripList:d,selectStops:n});case 38:case"end":return e.stop()}},e,null,[[5,15,19,27],[20,,22,26]])})),a.regenGraphSTM=Object(g.a)(b.a.mark(function e(){var t,n,r,i,s,c,o,l,u,p,d,m,f;return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=Object(E.a)(a.state.tripList),n=Object(E.a)(a.state.selectStops),r=!0,i=!1,s=void 0,e.prev=5,c=b.a.mark(function e(){var t,r;return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=l.value,0!==n.filter(function(e){return e.tripID===t}).length){e.next=6;break}return e.next=4,a.stopRequestSTM(t);case 4:r=e.sent,n.push({tripID:t,tripStops:r});case 6:case"end":return e.stop()}},e)}),o=t[Symbol.iterator]();case 8:if(r=(l=o.next()).done){e.next=13;break}return e.delegateYield(c(),"t0",10);case 10:r=!0,e.next=8;break;case 13:e.next=19;break;case 15:e.prev=15,e.t1=e.catch(5),i=!0,s=e.t1;case 19:e.prev=19,e.prev=20,r||null==o.return||o.return();case 22:if(e.prev=22,!i){e.next=25;break}throw s;case 25:return e.finish(22);case 26:return e.finish(19);case 27:return u=Object(E.a)(a.state.plannedTripsSTM),p=[],a.state.tripList.length>0?a.state.tripList.forEach(function(e){a.state.plannedTripsSTM.filter(function(t){return e===t.tripmin}).length>0&&p.push(e)}):"",d=[],p.length>0?p.forEach(function(e){a.state.vehiclesSTM.features.filter(function(t){return t.properties.trip_id===e}).length>0&&d.push(e)}):"",m=a.state.vehiclesSTM,f=a.state.tracesSTM,e.next=36,ee(d,u,n,m,f);case 36:u=e.sent,a.setState({plannedTripsWithGraphs:u,tripList:d,selectStops:n});case 38:case"end":return e.stop()}},e,null,[[5,15,19,27],[20,,22,26]])})),a.addToTripList=function(){var e=Object(g.a)(b.a.mark(function e(t){var n;return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:(n=Object(E.a)(a.state.tripList)).push(t),a.setState({tripList:n});case 3:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.removeFromTripList=function(){var e=Object(g.a)(b.a.mark(function e(t){var n,r,i;return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=Object(E.a)(a.state.tripList),r=n.indexOf(t),n.splice(r,1),(i=Object(E.a)(a.state.selectStops)).splice(r,1),a.setState({tripList:n,selectStops:i});case 6:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.handleTripClickRTL=function(){var e=Object(g.a)(b.a.mark(function e(t){return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:1===a.state.plannedTripsRTL.filter(function(e){return e.tripmin===t.target.innerHTML})[0].online&&0===a.state.tripList.filter(function(e){return e===t.target.innerHTML}).length?a.addToTripList(t.target.innerHTML):1===a.state.plannedTripsRTL.filter(function(e){return e.tripmin===t.target.innerHTML})[0].online&&a.state.tripList.filter(function(e){return e===t.target.innerHTML}).length>0?a.removeFromTripList(t.target.innerHTML):"";case 1:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.handleTripClickSTM=function(){var e=Object(g.a)(b.a.mark(function e(t){return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:1===a.state.plannedTripsSTM.filter(function(e){return e.tripmin===t.target.innerHTML})[0].online&&0===a.state.tripList.filter(function(e){return e===t.target.innerHTML}).length?a.addToTripList(t.target.innerHTML):1===a.state.plannedTripsSTM.filter(function(e){return e.tripmin===t.target.innerHTML})[0].online&&a.state.tripList.filter(function(e){return e===t.target.innerHTML}).length>0?a.removeFromTripList(t.target.innerHTML):"";case 1:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a}return Object(d.a)(t,e),Object(l.a)(t,[{key:"componentDidUpdate",value:function(e,t){var a=this.state,n=a.tripList,r=a.plannedTripsRTL,i=a.plannedTripsSTM,s=a.selectRTL,c=a.selectSTM;1===s&&r!==t.plannedTripsRTL&&this.regenGraphRTL(),1===s&&n.length!==t.tripList.length&&this.regenGraphRTL(),1===c&&i!==t.plannedTripsSTM&&this.regenGraphSTM(),1===c&&n.length!==t.tripList.length&&this.regenGraphSTM()}},{key:"render",value:function(){var e=this;return this.state.plannedTripsSTM?r.a.createElement("div",{className:"container-fluid"},r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-sm"},r.a.createElement("h1",{id:"title-card",className:"display-4"},"Vue lin\xe9aire : par voyage"))),r.a.createElement("div",{className:"row justify-content-center"},r.a.createElement("div",{className:"col-sm-4 mt-2 mb-2",style:{textAlign:"center",backgroundColor:"#E1FFE1"}},"Voyage planifi\xe9 actif"),r.a.createElement("div",{className:"col-sm-4 mt-2 mb-2",style:{textAlign:"center",backgroundColor:"#FFE2E2"}},"Voyage planifi\xe9 inactif")),r.a.createElement("div",{className:"row no-gutters"},r.a.createElement("div",{className:"col"},r.a.createElement("button",{id:"agency-card",type:"button",className:"col btn btn-outline-info",style:1===this.state.selectSTM?{backgroundColor:"#38B2A3",color:"#FFFFFF"}:{backgroundColor:"#E9F1F3",color:"#000000"},onClick:function(t){return e.handleClickSTM(t)}},"STM")),r.a.createElement("div",{className:"col"},r.a.createElement("button",{type:"button",className:"col btn btn-outline-secondary",disabled:!0},"STL")),r.a.createElement("div",{className:"col"},r.a.createElement("button",{type:"button",className:"col btn btn-outline-info",style:1===this.state.selectRTL?{backgroundColor:"#38B2A3",color:"#FFFFFF"}:{backgroundColor:"#E9F1F3",color:"#000000"},onClick:function(t){return e.handleClickRTL(t)}},"RTL"))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col"},r.a.createElement("table",{id:"tableOnline",className:"table"},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",{style:{width:"7.5%"}},"Ligne"),r.a.createElement("th",{style:{width:"7.5%"}},"Direction"),r.a.createElement("th",{style:{width:"7.5%"}},"D\xe9part"),r.a.createElement("th",{style:{width:"7.5%"}},"Arriv\xe9e"),r.a.createElement("th",{style:{width:"70%"}},"Trip ID"))),r.a.createElement("tbody",null,1===this.state.selectRTL&&this.state.plannedTripsWithGraphs.length>0?this.state.plannedTripsWithGraphs.map(function(t){return void 0===t.graph?r.a.createElement("tr",{key:t.keyid,style:{backgroundColor:1===t.online?"#E1FFE1":"#FFE2E2"}},r.a.createElement("td",null,t.route_id),r.a.createElement("td",null,1===t.direction_id?"Centre-Ville":"P\xe9riph\xe9rie"),r.a.createElement("td",null,ae("2019-05-10").startOf("day").seconds(t.timemin).format("H:mm:ss")),r.a.createElement("td",null,ae("2019-05-10").startOf("day").seconds(t.timemax).format("H:mm:ss")),r.a.createElement("td",{style:{cursor:1===t.online?"pointer":"default"},onClick:function(t){return e.handleTripClickRTL(t)}},t.tripmin)):r.a.createElement("tr",{key:t.keyid},r.a.createElement("td",{colSpan:"5",style:{backgroundColor:"#FFFFFF"}},t.tripmin))}):1===this.state.selectRTL&&0===this.state.plannedTripsWithGraphs.length?r.a.createElement("tr",null,r.a.createElement("td",{colSpan:"5",style:{textAlign:"center"}},r.a.createElement(J.a,{type:"bubbles",color:"#277D98",height:200,width:100}))):1===this.state.selectSTM&&this.state.plannedTripsWithGraphs.length>0?this.state.plannedTripsWithGraphs.map(function(t){return void 0===t.graph?r.a.createElement("tr",{key:t.keyid,style:{backgroundColor:1===t.online?"#E1FFE1":"#FFE2E2"}},r.a.createElement("td",null,t.route_id),r.a.createElement("td",null,t.direction_id),r.a.createElement("td",null,ae("2019-05-10").startOf("day").seconds(t.timemin).format("H:mm:ss")),r.a.createElement("td",null,ae("2019-05-10").startOf("day").seconds(t.timemax).format("H:mm:ss")),r.a.createElement("td",{style:{cursor:1===t.online?"pointer":"default"},onClick:function(t){return e.handleTripClickSTM(t)}},t.tripmin)):r.a.createElement("tr",{key:t.keyid},r.a.createElement("td",{colSpan:"5",style:{backgroundColor:"#FFFFFF"}},t.tripmin))}):1===this.state.selectSTM&&0===this.state.plannedTripsWithGraphs.length?r.a.createElement("tr",null,r.a.createElement("td",{colSpan:"4",style:{textAlign:"center"}},r.a.createElement(J.a,{type:"bubbles",color:"#277D98",height:200,width:100}))):r.a.createElement("tr",null,r.a.createElement("td",{colSpan:"5",style:{textAlign:"center"}}," S\xe9lectionner une agence"))))))):r.a.createElement("div",{className:"container"},r.a.createElement("div",{className:"row justify-content-center"},"Chargement en cours..."),r.a.createElement("div",{className:"row justify-content-center"},r.a.createElement("div",null,r.a.createElement(J.a,{type:"bars",color:"#277D98",height:300,width:175}))))}}]),t}(n.Component),re=a(55);function ie(e){var t=[];e.map(function(e){t.push({keyid:e.keyid,route_id:e.route_id,direction_id:e.direction_id,ligneDir:e.route_id+"_"+e.direction_id,online:e.online,stopcount:e.stopcount})});var a=t.filter(function(e){return 1===e.online});return Array.from(new Set(a.map(function(e){return e.ligneDir}))).map(function(e){return{ligneDir:e,keyid:t.find(function(t){return t.ligneDir===e}).keyid,route_id:t.find(function(t){return t.ligneDir===e}).route_id,direction_id:t.find(function(t){return t.ligneDir===e}).direction_id,online:t.find(function(t){return t.ligneDir===e}).online}})}function se(e,t,a,n,i,s){var c=0;return e.forEach(function(e){var o=t.filter(function(t){return t.ligneDir===e&&1===t.online}),l=[];a.map(function(e){l.push(e.ligneDir)});var u=l.indexOf(e),p=n[c].tripStops;c++;var d=[];p.features.map(function(e){d.push({name:e.properties.name,time:e.properties.departure_time,x:e.properties.stop_sequence,y:0,z:15})});var m=[];o.forEach(function(e){var t=i.features.filter(function(t){return t.properties.trip_id===e.tripmin})[0].geometry.coordinates,a=s.features.filter(function(t){return t.properties.trips.some(function(t){return t===e.tripmin})}),n=[];a[0].geometry.coordinates.map(function(e){n.push(e)});var r=re.lineString(n),c=re.point(t),o=re.nearestPointOnLine(r,c,{units:"kilometers"}),l={x:Math.round(1e3*o.properties.location),y:0,z:60};m.push(l)});a.splice(u+1,0,{keyid:u+1,graph:1,ligneDir:"graph",tripmin:r.a.createElement(U.b,{width:"98%",height:50},r.a.createElement(U.d,null,r.a.createElement(U.f,{type:"number",dataKey:"x",hide:!0}),r.a.createElement(U.g,{type:"number",dataKey:"y",hide:!0}),r.a.createElement(U.h,{type:"number",dataKey:"z",range:[10,100],domain:[15,75]}),r.a.createElement(U.e,{content:r.a.createElement(function(e){var t=e.active,a=e.payload;return t?r.a.createElement("div",{className:"custom-tooltip"},r.a.createElement("p",{className:"label"},a[0].payload.name,r.a.createElement("br",null),"Distance : ",a[0].payload.x,r.a.createElement("br",null))):null},null)}),r.a.createElement(U.c,{name:"Arrets",data:d,fill:"#000000",stroke:"#5B5B5B",line:!0,shape:"circle"}),r.a.createElement(U.c,{name:"Bus",data:m,fill:"#A93332",shape:"circle"})))})}),a}a(433);var ce=a(55);function oe(e){var t=[];e.map(function(e){t.push({keyid:e.keyid,route_id:e.route_id,direction_id:e.direction_id,ligneDir:e.route_id+"_"+e.direction_id,online:e.online,stopcount:e.stopcount,trip_id:e.tripmin})});var a=t.filter(function(e){return 1===e.online});return Array.from(new Set(a.map(function(e){return e.ligneDir}))).map(function(e){return{ligneDir:e,keyid:t.find(function(t){return t.ligneDir===e}).keyid,route_id:t.find(function(t){return t.ligneDir===e}).route_id,direction_id:t.find(function(t){return t.ligneDir===e}).direction_id,online:t.find(function(t){return t.ligneDir===e}).online}})}function le(e,t,a,n,i,s){var c=0;return e.forEach(function(e){var o=t.filter(function(t){return t.ligneDir===e&&1===t.online}),l=[];a.map(function(e){l.push(e.ligneDir)});var u=l.indexOf(e),p=n[c].tripStops,d=s.features.filter(function(e){return e.properties.trips.some(function(e){return e===n[c].tripID})});c++;var m=[];d[0].geometry.coordinates.map(function(e){m.push(e)});var f=ce.lineString(m),h=[];p.features.forEach(function(e){var t=ce.point(e.geometry.coordinates),a=ce.nearestPointOnLine(f,t,{units:"kilometers"}),n=Math.round(1e3*a.properties.location);h.push(n)});var v=[],T=0;p.features.map(function(e){v.push({name:e.properties.name,time:e.properties.departure_time,x:h[T],y:0,z:15}),T++});var E=[];o.forEach(function(e){var t=i.features.filter(function(t){return t.properties.trip_id===e.tripmin})[0].geometry.coordinates,a=s.features.filter(function(t){return t.properties.trips.some(function(t){return t===e.tripmin})}),n=[];a[0].geometry.coordinates.map(function(e){n.push(e)});var r=ce.lineString(n),c=ce.point(t),o=ce.nearestPointOnLine(r,c,{units:"kilometers"}),l={x:Math.round(1e3*o.properties.location),y:0,z:60};E.push(l)});a.splice(u+1,0,{keyid:u+1,graph:1,ligneDir:"graph",tripmin:r.a.createElement(U.b,{width:"98%",height:50},r.a.createElement(U.d,null,r.a.createElement(U.f,{type:"number",dataKey:"x",hide:!0}),r.a.createElement(U.g,{type:"number",dataKey:"y",hide:!0}),r.a.createElement(U.h,{type:"number",dataKey:"z",range:[10,100],domain:[15,75]}),r.a.createElement(U.e,{content:r.a.createElement(function(e){var t=e.active,a=e.payload;return t?r.a.createElement("div",{className:"custom-tooltip"},r.a.createElement("p",{className:"label"},a[0].payload.name,r.a.createElement("br",null),"Distance : ",a[0].payload.x,r.a.createElement("br",null))):null},null)}),r.a.createElement(U.c,{name:"Arrets",data:v,fill:"#000000",stroke:"#5B5B5B",line:!0,shape:"circle"}),r.a.createElement(U.c,{name:"Bus",data:E,fill:"#009DE0",shape:"circle"})))})}),a}var ue=function(e){function t(){var e,a;Object(o.a)(this,t);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(a=Object(u.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(r)))).state={routeList:[],selectStops:[],plannedRoutesWithGraphs:[],selectSTM:0,selectSTL:0,selectRTL:0},a.componentDidMount=Object(g.a)(b.a.mark(function e(){var t,n;return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,G();case 2:return t=e.sent,e.next=5,O();case 5:n=e.sent,k(function(e,r){var i=r?r[0].filter(function(e){return"STM"===e.reseau}):"",s=r?r[0].filter(function(e){return"STL"===e.reseau}):"",c=r?r[0].filter(function(e){return"RTL"===e.reseau}):"",o=0,l=(r[1].forEach(function(e){e.keyid=o,e.ligneDir=e.route_id+"_"+e.direction_id,o++,c[0].data.features.filter(function(t){return t.properties.trip_id===e.tripmin}).length>0?e.online=1:e.online=0}),ie(r[1])),u=0,p=(r[3].forEach(function(e){e.keyid=u,e.ligneDir=e.route_id+"_"+e.direction_id,u++,i[0].data.features.filter(function(t){return t.properties.trip_id===e.tripmin}).length>0?e.online=1:e.online=0}),oe(r[3]));a.setState({vehiclesSTM:r?i[0].data:"",vehiclesSTL:r?s[0].data:"",vehiclesRTL:r?c[0].data:"",timestampSTM:r?i[0].time:"",timestampSTL:r?s[0].time:"",timestampRTL:r?s[0].time:"",plannedTripsRTL:r?r[1]:"",plannedTripsSTL:r?r[2].sort(function(e,t){return e.timemin>t.timemin?1:-1}):"",plannedTripsSTM:r?r[3]:"",plannedRoutesRTL:l,plannedRoutesSTM:p,tracesRTL:t.rows[0].jsonb_build_object,tracesSTM:n.rows[0].jsonb_build_object})}),1===a.state.selectRTL&&a.state.plannedRoutesRTL&&a.regenGraphRoutesRTL(),1===a.state.selectSTM&&a.state.plannedRoutesSTM&&a.regenGraphRoutesSTM();case 9:case"end":return e.stop()}},e)})),a.componentWillUnmount=Object(g.a)(b.a.mark(function e(){return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:j();case 1:case"end":return e.stop()}},e)})),a.handleClickSTM=function(){var e=Object(g.a)(b.a.mark(function e(t){return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:a.setState({selectSTM:1,selectSTL:0,selectRTL:0,selectStops:[],routeList:[],plannedRoutesWithGraphs:[]});case 1:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.handleClickRTL=function(){var e=Object(g.a)(b.a.mark(function e(t){return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:a.setState({selectSTM:0,selectSTL:0,selectRTL:1,selectStops:[],routeList:[],plannedRoutesWithGraphs:[]});case 1:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.stopRequestRTL=function(){var e=Object(g.a)(b.a.mark(function e(t){var a,n;return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,V(t);case 2:return a=e.sent,n=a.rows[0].jsonb_build_object,e.abrupt("return",n);case 5:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.stopRequestSTM=function(){var e=Object(g.a)(b.a.mark(function e(t){var a,n;return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,N(t);case 2:return a=e.sent,n=a.rows[0].jsonb_build_object,e.abrupt("return",n);case 5:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.regenGraphRoutesRTL=Object(g.a)(b.a.mark(function e(){var t,n,r,i,s,c,o,l,u,p,d;return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=Object(E.a)(a.state.routeList),n=Object(E.a)(a.state.plannedTripsRTL),r=[],t.forEach(function(e){r.push(n.filter(function(t){return t.ligneDir===e})[0].tripmin)}),i=Object(E.a)(a.state.selectStops),s=b.a.mark(function e(){var t,n;return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=o[c],0!==i.filter(function(e){return e.tripID===t}).length){e.next=6;break}return e.next=4,a.stopRequestRTL(t);case 4:n=e.sent,i.push({tripID:t,tripStops:n});case 6:case"end":return e.stop()}},e)}),c=0,o=r;case 7:if(!(c<o.length)){e.next=12;break}return e.delegateYield(s(),"t0",9);case 9:c++,e.next=7;break;case 12:l=Object(E.a)(a.state.plannedRoutesRTL),u=a.state.tracesRTL,p=a.state.vehiclesRTL,l=se(t,n,l,i,p,u),d=0,l.forEach(function(e){e.keyid=d,d++}),a.setState({plannedRoutesWithGraphs:l,selectStops:i});case 19:case"end":return e.stop()}},e)})),a.regenGraphRoutesSTM=Object(g.a)(b.a.mark(function e(){var t,n,r,i,s,c,o,l,u,p,d;return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=Object(E.a)(a.state.routeList),n=Object(E.a)(a.state.plannedTripsSTM),r=[],t.forEach(function(e){r.push(n.filter(function(t){return t.ligneDir===e})[0].tripmin)}),i=Object(E.a)(a.state.selectStops),s=b.a.mark(function e(){var t,n;return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=o[c],0!==i.filter(function(e){return e.tripID===t}).length){e.next=6;break}return e.next=4,a.stopRequestSTM(t);case 4:n=e.sent,i.push({tripID:t,tripStops:n});case 6:case"end":return e.stop()}},e)}),c=0,o=r;case 7:if(!(c<o.length)){e.next=12;break}return e.delegateYield(s(),"t0",9);case 9:c++,e.next=7;break;case 12:l=Object(E.a)(a.state.plannedRoutesSTM),u=a.state.tracesSTM,p=a.state.vehiclesSTM,l=le(t,n,l,i,p,u),d=0,l.forEach(function(e){e.keyid=d,d++}),a.setState({plannedRoutesWithGraphs:l,selectStops:i});case 19:case"end":return e.stop()}},e)})),a.addToRouteList=function(){var e=Object(g.a)(b.a.mark(function e(t){var n;return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:(n=Object(E.a)(a.state.routeList)).push(t),a.setState({routeList:n});case 3:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.removeFromRouteList=function(){var e=Object(g.a)(b.a.mark(function e(t){var n,r,i;return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=Object(E.a)(a.state.routeList),r=n.indexOf(t),n.splice(r,1),(i=Object(E.a)(a.state.selectStops)).splice(r,1),a.setState({routeList:n,selectStops:i});case 6:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.handleRouteClickRTL=function(){var e=Object(g.a)(b.a.mark(function e(t){return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:1===a.state.plannedRoutesRTL.filter(function(e){return e.ligneDir===t.target.innerHTML})[0].online&&0===a.state.routeList.filter(function(e){return e===t.target.innerHTML}).length?a.addToRouteList(t.target.innerHTML):a.state.routeList.filter(function(e){return e===t.target.innerHTML}).length>0?a.removeFromRouteList(t.target.innerHTML):"";case 1:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.handleRouteClickSTM=function(){var e=Object(g.a)(b.a.mark(function e(t){return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:1===a.state.plannedRoutesSTM.filter(function(e){return e.ligneDir===t.target.innerHTML})[0].online&&0===a.state.routeList.filter(function(e){return e===t.target.innerHTML}).length?a.addToRouteList(t.target.innerHTML):a.state.routeList.filter(function(e){return e===t.target.innerHTML}).length>0?a.removeFromRouteList(t.target.innerHTML):"";case 1:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a}return Object(d.a)(t,e),Object(l.a)(t,[{key:"componentDidUpdate",value:function(e,t){var a=this.state,n=a.routeList,r=a.plannedRoutesRTL,i=a.plannedRoutesSTM,s=a.selectRTL,c=a.selectSTM;1===s&&n.length!==t.routeList.length&&this.regenGraphRoutesRTL(),1===s&&r!==t.plannedRoutesRTL&&this.regenGraphRoutesRTL(),1===c&&n.length!==t.routeList.length&&this.regenGraphRoutesSTM(),1===c&&i!==t.plannedRoutesSTM&&this.regenGraphRoutesSTM(),console.log(this.state)}},{key:"render",value:function(){var e=this;return this.state.plannedTripsSTM?r.a.createElement("div",{className:"container-fluid"},r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-sm"},r.a.createElement("h1",{id:"title-card",className:"display-4"},"Vue lin\xe9aire par ligne"))),r.a.createElement("div",{className:"row justify-content-center"},r.a.createElement("div",{className:"col-sm-4 mt-2 mb-2",style:{textAlign:"center",backgroundColor:"#E1FFE1"}},"Voyage planifi\xe9 actif"),r.a.createElement("div",{className:"col-sm-4 mt-2 mb-2",style:{textAlign:"center",backgroundColor:"#FFE2E2"}},"Voyage planifi\xe9 inactif")),r.a.createElement("div",{className:"row no-gutters"},r.a.createElement("div",{className:"col"},r.a.createElement("button",{id:"agency-card",type:"button",className:"col btn btn-outline-info",style:1===this.state.selectSTM?{backgroundColor:"#38B2A3",color:"#FFFFFF"}:{backgroundColor:"#E9F1F3",color:"#000000"},onClick:function(t){return e.handleClickSTM(t)}},"STM")),r.a.createElement("div",{className:"col"},r.a.createElement("button",{type:"button",className:"col btn btn-outline-secondary",disabled:!0},"STL")),r.a.createElement("div",{className:"col"},r.a.createElement("button",{type:"button",className:"col btn btn-outline-info",style:1===this.state.selectRTL?{backgroundColor:"#38B2A3",color:"#FFFFFF"}:{backgroundColor:"#E9F1F3",color:"#000000"},onClick:function(t){return e.handleClickRTL(t)}},"RTL"))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col"},r.a.createElement("table",{id:"tableOnline",className:"table"},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",{style:{width:"10%"}},"Ligne"),r.a.createElement("th",{style:{width:"20%"}},"Direction"),r.a.createElement("th",{style:{width:"70%"}},"Ligne-dir"))),r.a.createElement("tbody",null,1===this.state.selectRTL&&this.state.plannedRoutesWithGraphs.length>0?this.state.plannedRoutesWithGraphs.map(function(t){return void 0===t.graph?r.a.createElement("tr",{key:t.keyid,style:{backgroundColor:1===t.online?"#E1FFE1":"#FFE2E2"}},r.a.createElement("td",null,t.route_id),r.a.createElement("td",null,1===t.direction_id?"1":"0"),r.a.createElement("td",{style:{cursor:1===t.online?"pointer":"default"},onClick:function(t){return e.handleRouteClickRTL(t)}},t.ligneDir)):r.a.createElement("tr",{key:t.keyid},r.a.createElement("td",{colSpan:"3"},t.tripmin))}):1===this.state.selectRTL&&0===this.state.plannedRoutesWithGraphs.length?r.a.createElement("tr",null,r.a.createElement("td",{colSpan:"3",style:{textAlign:"center"}},r.a.createElement(J.a,{type:"bubbles",color:"#277D98",height:200,width:100}))):1===this.state.selectSTM&&this.state.plannedRoutesWithGraphs.length>0?this.state.plannedRoutesWithGraphs.map(function(t){return void 0===t.graph?r.a.createElement("tr",{key:t.keyid,style:{backgroundColor:1===t.online?"#E1FFE1":"#FFE2E2"}},r.a.createElement("td",null,t.route_id),r.a.createElement("td",null,t.direction_id),r.a.createElement("td",{style:{cursor:1===t.online?"pointer":"default"},onClick:function(t){return e.handleRouteClickSTM(t)}},t.ligneDir)):r.a.createElement("tr",{key:t.keyid},r.a.createElement("td",{colSpan:"3"},t.tripmin))}):1===this.state.selectSTM&&0===this.state.plannedRoutesWithGraphs.length?r.a.createElement("tr",null,r.a.createElement("td",{colSpan:"3",style:{textAlign:"center"}},r.a.createElement(J.a,{type:"bubbles",color:"#277D98",height:200,width:100}))):r.a.createElement("tr",null,r.a.createElement("td",{colSpan:"3",style:{textAlign:"center"}}," S\xe9lectionner une agence"))))))):r.a.createElement("div",{className:"container"},r.a.createElement("div",{className:"row justify-content-center"},"Chargement en cours..."),r.a.createElement("div",{className:"row justify-content-center"},r.a.createElement("div",null,r.a.createElement(J.a,{type:"bars",color:"#277D98",height:300,width:175}))))}}]),t}(n.Component),pe=a(176),de=function(e){function t(){var e,a;Object(o.a)(this,t);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(a=Object(u.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(r)))).state={history:null},a.componentDidMount=Object(g.a)(b.a.mark(function e(){var t,n,r,i,s;return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,W();case 2:t=e.sent,n=[],t?t.forEach(function(e){n.push({time:parseInt(pe("2019-04-28 "+e.timestr).format("x")),vehlen:Number(e.sum),weekday:e.weekday,date:e.rid.substr(0,4)+"-"+e.rid.substr(4,2)+"-"+e.rid.substr(6,2),groupe:e.groupe,rid:e.rid})}):"",r=n.filter(function(e){return parseInt(e.weekday)>0&&parseInt(e.weekday)<6}),i=n.filter(function(e){return 6===parseInt(e.weekday)}),s=n.filter(function(e){return 0===parseInt(e.weekday)}),a.setState({week:r,saturday:i,sunday:s});case 9:case"end":return e.stop()}},e)})),a}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=function(e){var t=e.active,a=e.payload;return t?r.a.createElement("div",{className:"custom-tooltip"},r.a.createElement("p",{className:"label"},"Agence : ",a[0].payload.groupe,r.a.createElement("br",null),"Date : ",a[0].payload.date," ",r.a.createElement("br",null),"Heure : ",pe(a[0].payload.time).format("HH:mm:ss"),r.a.createElement("br",null),"V\xe9hicules actifs : ",a[0].payload.vehlen)):null};return this.state.sunday?r.a.createElement("div",{className:"container-fluid"},r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-sm"},r.a.createElement("h1",{id:"title-card",className:"display-4"},"V\xe9hicules actifs dans les 3 derniers jours"))),r.a.createElement("div",{id:"chart-card"},r.a.createElement("h4",{style:{color:"#000000",textAlign:"center"}},"Semaine"),r.a.createElement(U.b,{width:"100%",height:350},r.a.createElement(U.d,{width:730,height:250,margin:{top:5,right:30,left:20,bottom:5}},r.a.createElement(U.f,{type:"number",dataKey:"time",name:"time",domain:[155642076e4,1556495999e3],tickFormatter:function(e){return pe(e).format("HH:mm:ss")},ticks:[1556424000100,15564276e5,15564312e5,15564348e5,15564384e5,1556442e6,15564456e5,15564492e5,15564528e5,15564564e5,155646e7,15564636e5,15564672e5,15564708e5,15564744e5,1556478e6,15564816e5,15564852e5,15564888e5,15564924e5,1556496e6,15564996e5,15565032e5,15565068e5,1556510399900]}),r.a.createElement(U.g,{yAxisId:"left",dataKey:"vehlen",name:"v\xe9hicules",label:{value:"STM",angle:-90,position:"insideLeft"}}),r.a.createElement(U.g,{yAxisId:"right",orientation:"right",dataKey:"vehlen",name:"v\xe9hicules",label:{value:"STL, RTL, exo",angle:-90,position:"right"}}),r.a.createElement(U.h,{dataKey:"z",range:[10]}),r.a.createElement(U.e,{content:r.a.createElement(e,null)}),r.a.createElement(U.a,null),r.a.createElement(U.c,{yAxisId:"left",name:"STM",data:this.state.week.filter(function(e){return"STM"===e.groupe}),fill:"#009DE0"}),r.a.createElement(U.c,{yAxisId:"right",name:"STL",data:this.state.week.filter(function(e){return"STL"===e.groupe}),fill:"#82C341"}),r.a.createElement(U.c,{yAxisId:"right",name:"RTL",data:this.state.week.filter(function(e){return"RTL"===e.groupe}),fill:"#A93332"}),r.a.createElement(U.c,{yAxisId:"right",name:"exo",data:this.state.week.filter(function(e){return"exo"===e.groupe}),fill:"#000000"})))),r.a.createElement("div",{id:"chart-card"},r.a.createElement("h4",{style:{color:"#000000",textAlign:"center"}},"Samedi"),r.a.createElement(U.b,{width:"100%",height:350},r.a.createElement(U.d,{width:730,height:250,margin:{top:5,right:30,left:20,bottom:5}},r.a.createElement(U.f,{type:"number",dataKey:"time",name:"time",domain:[155642076e4,1556495999e3],tickFormatter:function(e){return pe(e).format("HH:mm:ss")},ticks:[1556424000100,15564276e5,15564312e5,15564348e5,15564384e5,1556442e6,15564456e5,15564492e5,15564528e5,15564564e5,155646e7,15564636e5,15564672e5,15564708e5,15564744e5,1556478e6,15564816e5,15564852e5,15564888e5,15564924e5,1556496e6,15564996e5,15565032e5,15565068e5,1556510399900]}),r.a.createElement(U.g,{yAxisId:"left",dataKey:"vehlen",name:"v\xe9hicules",label:{value:"STM",angle:-90,position:"insideLeft"}}),r.a.createElement(U.g,{yAxisId:"right",orientation:"right",dataKey:"vehlen",name:"v\xe9hicules",label:{value:"STL, RTL, exo",angle:-90,position:"right"}}),r.a.createElement(U.h,{dataKey:"z",range:[10]}),r.a.createElement(U.e,{content:r.a.createElement(e,null)}),r.a.createElement(U.a,null),r.a.createElement(U.c,{yAxisId:"left",name:"STM",data:this.state.saturday.filter(function(e){return"STM"===e.groupe}),fill:"#009DE0"}),r.a.createElement(U.c,{yAxisId:"right",name:"STL",data:this.state.saturday.filter(function(e){return"STL"===e.groupe}),fill:"#82C341"}),r.a.createElement(U.c,{yAxisId:"right",name:"RTL",data:this.state.saturday.filter(function(e){return"RTL"===e.groupe}),fill:"#A93332"}),r.a.createElement(U.c,{yAxisId:"right",name:"exo",data:this.state.saturday.filter(function(e){return"exo"===e.groupe}),fill:"#000000"})))),r.a.createElement("div",{id:"chart-card"},r.a.createElement("h4",{style:{color:"#000000",textAlign:"center"}},"Dimanche"),r.a.createElement(U.b,{width:"100%",height:350},r.a.createElement(U.d,{width:500,height:250,margin:{top:5,right:30,left:20,bottom:5}},r.a.createElement(U.f,{type:"number",dataKey:"time",name:"time",domain:[155642076e4,1556495999e3],tickFormatter:function(e){return pe(e).format("HH:mm:ss")},ticks:[1556424000100,15564276e5,15564312e5,15564348e5,15564384e5,1556442e6,15564456e5,15564492e5,15564528e5,15564564e5,155646e7,15564636e5,15564672e5,15564708e5,15564744e5,1556478e6,15564816e5,15564852e5,15564888e5,15564924e5,1556496e6,15564996e5,15565032e5,15565068e5,1556510399900]}),r.a.createElement(U.g,{yAxisId:"left",dataKey:"vehlen",name:"v\xe9hicules",label:{value:"STM",angle:-90,position:"insideLeft"}}),r.a.createElement(U.g,{yAxisId:"right",orientation:"right",dataKey:"vehlen",name:"v\xe9hicules",label:{value:"STL, RTL, exo",angle:-90,position:"right"}}),r.a.createElement(U.h,{dataKey:"z",range:[10]}),r.a.createElement(U.e,{content:r.a.createElement(e,null)}),r.a.createElement(U.a,null),r.a.createElement(U.c,{yAxisId:"left",name:"STM",data:this.state.sunday.filter(function(e){return"STM"===e.groupe}),fill:"#009DE0"}),r.a.createElement(U.c,{yAxisId:"right",name:"STL",data:this.state.sunday.filter(function(e){return"STL"===e.groupe}),fill:"#82C341"}),r.a.createElement(U.c,{yAxisId:"right",name:"RTL",data:this.state.sunday.filter(function(e){return"RTL"===e.groupe}),fill:"#A93332"}),r.a.createElement(U.c,{yAxisId:"right",name:"exo",data:this.state.sunday.filter(function(e){return"exo"===e.groupe}),fill:"#000000"}))))):r.a.createElement("div",{className:"container"},r.a.createElement("div",{className:"row justify-content-center"},"Chargement en cours..."),r.a.createElement("div",{className:"row justify-content-center"},r.a.createElement("div",null,r.a.createElement(J.a,{type:"bars",color:"#277D98",height:300,width:175}))))}}]),t}(n.Component),me=function(e){function t(){var e,a;Object(o.a)(this,t);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(a=Object(u.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(r)))).state={},a.componentDidMount=Object(g.a)(b.a.mark(function e(){return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,B();case 2:e.sent,a.setState({});case 4:case"end":return e.stop()}},e)})),a}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return this.state.sunday?r.a.createElement("div",{className:"container"}):r.a.createElement("div",{className:"container"},r.a.createElement("div",{className:"row justify-content-center"},"Chargement en cours..."),r.a.createElement("div",{className:"row justify-content-center"},r.a.createElement("div",null,r.a.createElement(J.a,{type:"bars",color:"#277D98",height:300,width:175}))))}}]),t}(n.Component),fe=function(){return r.a.createElement(h.c,null,r.a.createElement(h.a,{exact:!0,path:"/",component:q}),r.a.createElement(h.a,{exact:!0,path:"/historique",component:de}),r.a.createElement(h.a,{exact:!0,path:"/livetrips",component:ne}),r.a.createElement(h.a,{exact:!0,path:"/liveroutes",component:ue}),r.a.createElement(h.a,{exact:!0,path:"/statsgtfs",component:me}),r.a.createElement(h.a,{exact:!0,path:"/howto",component:T}),r.a.createElement(h.a,{path:"*",component:v}))},he=(a(436),function(e){function t(){return Object(o.a)(this,t),Object(u.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(m,null),r.a.createElement("main",{id:"app"},r.a.createElement(fe,null)),r.a.createElement(f,null))}}]),t}(n.Component));s.a.render(r.a.createElement(c.a,null,r.a.createElement(he,null)),document.getElementById("root"))}},[[215,1,2]]]);
//# sourceMappingURL=main.a8d71b84.chunk.js.map